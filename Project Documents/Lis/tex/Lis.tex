\documentclass[twoside]{projektInzynierskiMS}
\usepackage{polski}
\usepackage[cp1250]{inputenc}
%\usepackage{amsmath}
\usepackage{listings}
%\usepackage{xcolor}
\usepackage{color}
\usepackage{graphicx}
%\drukJednostronny
\usepackage{tabto}


%% tytu≥ promotor i autor (\title to komenda standardowa)
\title{Projekt i wykonanie aplikacji bazodanowej wspomagajπcej pracÍ wybranej sieci hotelowej}
\promotor{dr. Jaros≥aw Karcewicz}


%% kaødy autor musi mieÊ 4 argumenty: imiÍ nazwisko, nr albumu, procent wk≥adu, opis wk≥adu
\autor{£ukasz Lis}{112233}{1} {Wk≥ad pracy lisa}
	
\autor{Sebastian Nalepka}{225265}{3} {Wk≥ad pracy seby}

\autor{Mateusz Ogiermann}{112233}{0}	
{Wk≥ad pracy ogi}
	
	


%% dedykacja mile widziana
\dedykacja{To jest\\dedykacja}
%\NumeryNaPoczatku
%% numeracja wzorÛw tu w≥πczona typu (1.2.3), ta druga to typu (1.2), a domyúlnie typu (1)
%\subsectionWzory
% \sectionWzory  

%\rozdzialy


%\literowaNumeracjaDodatkow %% w≥πczy numeracjÍ dodatkÛw literami
%\rzymskaNumeracjaDodatkow  %%w≥πczy numeracjÍ dodatkÛw liczbami rzymskimi

%% wy≥πczenie wyjaúnieÒ:
\bezWyjasnien

%% standardowe komendy \newtheorem  dzia≥ajπ jak w oryginale
%\newtheorem{tw}{Twierdzenie}[subsection]
%\newtheorem{twa}{Twierdzenie}[section]
%\newtheorem{dd}{Definicja}[subsection]

\begin{document}
\TabPositions{0.75cm}
Obecna sytuacja rynkowa zwiπzana z istnieniem duøej iloúci firm w zakresie kaødej branøy wymusza na przedsiÍbiorcach ciπg≥e zwiÍkszanie swojej atrakcyjnoúci oraz konkurencyjnoúci w celu zdobycia potencjalnego klienta. W realizacji powyøszego zadania konieczne jest wdraøanie nowoczesnych metod umoøliwiajπcych miÍdzy innymi obniøenie kosztÛw pracy, co wprost przek≥ada siÍ na niøszπ cenÍ produktu koÒcowego. Niøsza cena dla klienta jest jednym z najwaøniejszych elementÛw, ktÛry determinuje wybÛr konkretnego us≥ugodawcy. Aspekt ten dotyczy takøe branøy hotelarskiej, ktÛra w sposÛb bezpoúredni dotyczy naszej pracy.
	Liczba hoteli w Polsce od kilkunastu lat nieprzerwanie roúnie \cite{LiczbaHoteli}. Implikuje to koniecznoúÊ wzmoøonej walki o klienta w celu utrzymania siÍ na rynku. Obniøenie cen us≥ug wynajmu pokoi, sal konferencyjnych oraz cateringÛw przy zachowaniu odpowiedniego poziomu dochodÛw jest problemem, z ktÛrym zmaga siÍ kaøda sieÊ hotelowa. PrzedsiÍbiorcy przeúcigajπ siÍ w znajdowaniu coraz to nowszych i efektywniejszych rozwiπzaÒ, ktÛre majπ na celu rozwiπzanie owego problemu. W XXI wieku duøπ pomocπ w tym zakresie okazuje siÍ informatyzacja.

\section{Geneza projektu}

Podczas przeprowadzania transakcji dotyczπcej organizacji szkolenia w jednej z sieci hotelowych, dostrzeøony zosta≥ potencjalny problem wynikajπcy z manualnego operowania wszelkimi danymi przez pracownikÛw dzia≥u sprzedaøy. Pracownicy Ci w czasie spotkania z klientem majπ za zadanie ustalenie wszelkich wartoúci cenowych us≥ug wybranych przez klienta. Us≥ugi te bezpoúrednio zwiπzane sπ z typem wydarzenia, ktÛre klient chce zorganizowaÊ. Przewaønie sπ to wszelkiego rodzaju konferencje, kilkudniowe szkolenia firmowe, ale takøe imprezy weselne, urodzinowe, czy spotkania rodzinne. Przez wzglπd na rÛønπ specyfikÍ powyøszych przedsiÍwziÍÊ sieÊ hotelowa dysponuje szerokπ gamπ us≥ug z nimi zwiπzanych. 

W czasie tworzenia przez sprzedawcÍ propozycji cenowej organizowanego wydarzenia, klient ma moøliwoúÊ wyboru odpowiedniej dla jego potrzeb sali konferencyjnej lub bankietowej wraz z jej dodatkowym wyposaøeniem, ustalenia aspektÛw gastronomicznych, takich jak liczba i rodzaj posi≥kÛw oraz napojÛw, a takøe wyborem odpowiedniego typu pokoju hotelowego. Po wstÍpnym wyborze zakresu us≥ug, elementy te uzupe≥niane sπ o liczbÍ osÛb, ktÛre bÍdπ w wydarzeniu uczestniczyÊ, a takøe iloúÊ dni jego trwania. Kolejnym etapem jest negocjacja rabatÛw oraz finalnie ustalenie formy zap≥aty za organizowane przedsiÍwziÍcie. Aktualnie operacja ta wraz z procesem tworzeniem dokumentu propozycji cenowej przeprowadzana jest za pomocπ aplikacji Microsoft Excel jak rÛwnieø w wersji papierowej. Obydwie metodologie generujπ liczne problemy, ktÛre bezpoúrednio wp≥ywajπ na zwiÍkszenie kosztÛw generowanych przez pracownikÛw, a co za tym idzie ceny oferowanych us≥ug. Pierwszy problem odnosi siÍ do aspektu utrudnienia aktualizacji danych, ktÛry jest nieod≥πcznym elementem branøy. Ceny pokoi hotelowych ulegajπ czÍstym modyfikacjom oraz uzaleønione sπ od sytuacji rynkowej, organizowanych okolicznych wydarzeÒ rozrywkowych i kulturalnych oraz samego faktu wolnej ich iloúci w danym czasie. Analogicznie sytuacja przedstawia siÍ w przypadku produktÛw gastronomicznych oraz pozosta≥ych wynajmowanych pomieszczeÒ.

Aktualnie wszelkie modyfikacje cennikÛw pokoi hotelowych, sal moøliwych do wynajÍcia oraz dostÍpnych towarÛw dokonywane sπ przez menadøera sprzedaøy, ktÛry za poúrednictwem poczty elektronicznej przekazuje uaktualnione wersje arkuszy kalkulacyjnych oraz listy cen okreúlonym sprzedawcom. CzÍste zmiany zobowiπzujπ pracownikÛw dzia≥u sprzedaøy do ciπg≥ej kontroli skrzynki elektronicznej oraz powodujπ presjÍ spowodowanπ posiadaniem potencjalnie nieaktualnych danych. Zaawansowane arkusze kalkulacyjne wykonane w aplikacji Excel podatne sπ na b≥Ídy ludzkie, wymuszajπ na pracownikach dobrπ znajomoúÊ oprogramowania oraz umiejÍtnoúÊ jego obs≥ugi, co z kolei niekorzystnie przek≥ada siÍ na nowych pracownikÛw oraz pracodawcÍ, ktÛry zobowiπzany jest przeprowadzaÊ d≥ugie i kosztowne szkolenia w tym zakresie.
Kolejnym dostrzeøonym problemem jest zagadnienie czasoch≥onnoúci wyszukiwania danych dotyczπcych produktÛw znajdujπcych siÍ na hotelowej restauracji i ich cen. Pracownik otrzymuje rozbudowanπ listÍ produktÛw wraz z przyporzπdkowanymi im cenami i we w≥asnym zakresie zobligowany jest znaleüÊ interesujπcπ go pozycjÍ w czasie przygotowywania propozycji cenowej. 

Dostrzegajπc powyøsze problemy zdecydowano siÍ wykonaÊ dedykowanπ aplikacjÍ bazodanowπ, ktÛrej celem jest ich rozwiπzanie. Za≥oøono, øe konieczne by by≥o, aby kaødy ze sprzedawcÛw posiada≥ moøliwoúÊ uruchomienia na swoim s≥uøbowym komputerze programu, ktÛry dziÍki po≥πczeniu z bazπ danych i wykorzystaniu jej funkcjonalnoúci umoøliwi≥by przyspieszenie procesu przeprowadzania transakcji z klientem poprzez automatycznπ aktualizacjÍ cennikÛw oraz przedstawienie listy produktÛw gastronomicznych w skategoryzowany sposÛb. DziÍki przechowywaniu wszystkich propozycji cenowych w bazie danych, zanika≥aby koniecznoúÊ samodzielnej ich kategoryzacji i dbania o bezpieczeÒstwo na lokalnym komputerze. Umoøliwi≥oby to pracownikom pracÍ na rÛønych maszynach, co w znaczny sposÛb zwiÍkszy≥oby ich elastycznoúÊ.

Kolejnym atutem przedstawionego rozwiπzania by≥oby umoøliwienie kierownictwu z poziomu kont administratorskich kontroli pracownikÛw poprzez zdalny wglπd w przygotowywane przez nich propozycje cenowe, a co za tym idzie ustalanych z klientem cen oraz zniøek. Menadøer sprzedaøy za pomocπ swojego uprzywilejowanego konta posiada≥by rÛwnieø moøliwoúÊ aktualizacji odpowiednich tabel danych, dziÍki czemu zmiany natychmiastowo by≥yby widocznie na kontach sprzedawcÛw. Zmiany te dotyczy≥yby moøliwoúci modyfikacji cen oferowanych us≥ug i produktÛw oraz kontroli sk≥adu pracowniczego poprzez funkcjonalnoúÊ dodawania, usuwania a takøe modyfikacji ich kont. 

\thesection,\thesubsection,\thesubsubsection,

\section{Analiza przedwdroøeniowa}
\section{Istniejπce rozwiπzania konkurencyjne}
Wraz ze wzrostem liczby firm \cite{iloscFirm} dzia≥ajπcych w Polsce istnieje koniecznoúÊ lepszego, szybszego zarzπdzania. Wiπøe siÍ to z rozwojem informatyzacji. Moøna w ten sposÛb zautomatyzowaÊ wiele procesÛw w firmie miedzy innymi: zarzπdzanie magazynem, kontrolÍ sprzedaøy, zapotrzebowanie przedsiÍbiorstwa na rÛøne produkty. Do tego celu wdraøane sπ zintegrowane systemy informatyczne, ktÛrych zadaniem jest po≥πczenie wszystkich elementÛw przedsiÍbiorstwa, w jeden scentralizowany system. Wykorzystuje siÍ do tego oprogramowania klasy ERP (ang. enterprise resource planning ñ ERP)\cite{SystemERP}. W sk≥ad takiego oprogramowania moøe wchodziÊ wiele modu≥Ûw: finansowoúÊ, stany magazynowe, kontakt z klientem, w zaleønoúci, co w danym przedsiÍbiorstwie jest wymagane. Wymogiem takiego systemu jest by wszystkie modu≥y by≥y niezaleøne, poniewaø kaøda firma nie potrzebuje ich wszystkich, ale muszπ siÍ umieÊ z sobπ komunikowaÊ by mÛc w lepszy sposÛb zarzπdzaÊ. W wypadku kontaktu z klientem wprowadza siÍ systemy, ktÛre sprawnie obs≥ugujπ sprawy zwiπzane z reklamacjami, wsparciem technicznym i innymi rzeczami zwiπzanymi z jego obs≥ugπ. Z tym zwiπzane jest wystawianie propozycji cenowej. Jest to proces czasoch≥onny ze wzglÍdu na koniecznoúÊ aktualizowania cennikÛw, moøliwego wyposaøenia sal i innych spraw zwiπzanych z organizowanym wydarzeniem. Modu≥ CRM(ang. customer relationship management ñ CRM), ktÛry wspomaga proces kontaktu z klientem zawiera komponent wspomaganie procesu wystawiania propozycji. Komponent ten nie tylko automatyzuje proces wystawiania propozycji cenowej, ale jest rÛwnieø odpowiedzialny, za sprzedaø oferowanych towarÛw i us≥ug. W nastÍpnej czÍúci tego rozdzia≥u przedstawiono rÛøne systemy CRM, ktÛrych istnieje wersja darmowa.

Do sprawdzenia dostÍpnych rozwiπzaÒ zosta≥y wytypowane trzy program, ktÛre spe≥niajπ wymagania sieci hotelowej sπ to: ProfitCRM\cite{ProfitCRM} i Asystent CRM\cite{AsystentCRM} Gestor GT \cite{Gestor}.

\begin{itemize}
\item \textsl{Interfejs uøytkownika} 

\tab Wyglπd aplikacji w niektÛrych przypadka pozostawia≥ wiele do øyczenia a niektÛre zaskoczy≥y nietypowym interfejsem. W przypadku programu ProfitCRM interfejs uøytkownika jest trochÍ za bardzo poúciskany, co utrudnia≥o znalezienie odpowiednich elementÛw potrzebnych w danym momencie. Najistotniejszπ wadπ programu jest bardzo wolno reagujπcy interfejs uøytkownika, co utrudnia pracÍ. CzÍsto zdarza siÍ, øe jakieú okienko np. edycja szablonÛw zniknie i nie ma moøliwoúci robienia czegokolwiek w programie. Bardzo ma≥o intuicyjnie zorganizowany jest zapis oferty do formatu PDF, poniewaø nie robi siÍ tego poprzez przycisk drukuj tylko poprzez podglπd dokumentu i eksportuj do PDF. Kiedy dodawany jest nowy towar lub teø us≥uga otwiera siÍ nowe okno z polami, ktÛre trzeba wype≥niÊ. Sπ to nazwa, kod towaru. Niestety us≥ugi te muszπ mieÊ jednostkÍ miary. W tym teø oknie istnieje moøliwoúÊ dodawania zdjÍÊ, komentarzy i dodawania ich do grup.  Drugim ze sposobÛw dodawania towaru jest klikniÍcie w o≥Ûwek, ktÛry moøna zaobserwowaÊ na rysunku
\ref{rys:rysunek olowka}

 w procesie tworzenia oferty.
  \begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{olowek.jpg}
    \caption{SposÛb dodawania towaru w ofercie, èrÛd≥o: Opracowanie w≥asne.}
    \label{rys:rysunek olowka}
\end{figure}

Wymagane wtedy sπ tyko podstawowe elementy jak nazwa, kod i jednostka miary towaru. Podobny interfejs uøytkownika prezentuje Asystent CRM z tπ tyko rÛønicπ, øe jego przyciski sπ zdecydowanie wiÍksze i jest ich teø mniej w jednym oknie. DziÍki przejrzystemu interfejsowi uøytkownika przedstawia rysunek \ref {rys:interfejsAsystenta}

 jest bardzo prosta nawigacja w programie.
 
 \begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{IntejfejsAsystent.jpg}
    \caption{Interfejs programu Asysten CRM, èrÛd≥o: Opracowanie w≥asne.}
    \label{rys:interfejsAsystenta}
\end{figure}

  Dodawanie nowych produkty odbywa poprzez magazyn lub teø bezpoúrednio przy tworzonej ofercie. Program Gestor GT ca≥kowicie zmieni≥ podejúcie do interfejsu uøytkownika przedstawia rysunek \ref {rys:interfejsGestor} z tych trzech jest najbardziej przejrzystym interfejsem, ale niestety ma≥o intuicyjnym na przyk≥ad dodawanie nowych produktÛw jest tutaj bardzo utrudnione i bardziej skomplikowane niø w poprzednich. Wynika to z faktu ukrycia czÍúci elementÛw w g≥Ûwnym interfejsie.
 \begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{interfejsGestor.JPG}
    \caption{Interfejs programu Gestor GT, èrÛd≥o: Opracowanie w≥asne.}
    \label{rys:interfejsGestor}
\end{figure}  

\item \textsl{D≥ugoúÊ wersji darmowej} 

\tab Testowane programy ProfitCRM i Asystent CRM dzia≥ajπ w wersji darmowej przez 30 dni, jedynie Gestor GT w wersji darmowej moøna uøywaÊ przez 45 dni. W ProfitCRM  i Gestor GT dodawany jest Microsoft SQL Server 2008. Asystent CRM jest pozbawiony dodatkowych moøliwoúci.

\item \textsl{Tworzenie szablonÛw typu dokumentÛw} 

\tab W programie ProfitCRM  istnieje rÛwnieø moøliwoúÊ zdefiniowania w≥asnego szablonu. Proces tworzenia nowego szablonu jest procesem skomplikowanym. Najlepszym rozwiπzanie jest skopiowanie istniejπcych w systemie szablonÛw, poniewaø ich edycja jest zablokowana.  NastÍpnie edytowanie skopiowanego. Nie powiod≥o siÍ rÛwnieø wygenerowanie PDF o wyglπdzie zbliøonym do wyglπdu przedstawionego przez sieÊ hotelowπ. . Niestety w programie Asystent CRM edycja wzorÛw dokumentÛw do druku jest bardzo trudna w realizacji dla zwyk≥ego sprzedawcy. Jest to spowodowane sposobem edycji. Bez znajomoúci programowania nie ma moøliwoúÊ stworzyÊ nowej wersji dokumentu, co utrudnia zmianÍ wyglπdu pod danπ firmÍ. W ostatnim przetestowanym programie czyli Gestor GT nie ma øadnej moøliwoúci edycji szablonÛw dokumentÛw.

\item \textsl{Cena}
 
\tab Koszt licencji programu ProfitCRM na jedno stanowisko pracy wynosi 736 z≥ w przypadku programu Asystent CRM, w zaleønoúci od wersji od 79-369 z≥. Gestor GT kosztuje 859.77z≥ jest to najdroøszy produkt z poúrÛd wybranych
\end{itemize}
\subsubsection{WPF}
WPF (ang. Windows Presentation Foundation) \cite{WPF} jest technologiπ wprowadzonπ w .Net 3.0. Wykorzystuje jÍzyk XML, a dok≥adnie jego odmianÍ XAML. Do wyúwietlania okien wykorzystywana jest grafika wektorowa, co jest wspomagane przez karty graficzne. Cechuje siÍ on bardzo duøπ elastycznoúciπ w tworzeniu interfejsu, miedzy innymi tworzenie przycisku z obrazkiem. Technologia ta zosta≥a zaprojektowana, tak øeby w jak najwiÍkszym stopniu odseparowaÊ wyglπd aplikacji od innych warstw programu. W niektÛrych przypadkach wiπøe siÍ z dodatkowym nak≥adem pracy w stosunku do technologii Winforms  np. wyúwietlany obrazek w kontrolerze ListView . Jeúli chodzi o wyglπd aplikacji dziÍki duøej elastycznoúci jest moøliwe tworzenie programÛw z interfejsem 3D. Nie tylko rÛøni siÍ moøliwoúciami tworzenia interfejsÛw, ale i wewnÍtrznymi mechanizmami. WPF wykorzystuje dedykowany mechanizm do prezentacji aplikacji, w stosunku do WinformsÛw, ktÛry wywo≥uje tylko elementy WinAPI. Wiπøe siÍ to z brakiem wiÍkszych moøliwoúci edycji wyglπdu aplikacji. NastÍpnπ cechπ istotnπ z punktu dzia≥ania programu jest odúwieøanie elementÛw okna. W przypadku Winformsach najechanie na jakikolwiek element z w≥aúciwoúciπ zmiany wyglπdu np. zmiany podúwietlania po najechaniu powoduje odúwieøenie ca≥ego okna programu, co nie ma miejsca w przypadku programÛw tworzonych w WPF. Bardzo dobre wsparcie dla wzorca architektonicznego MVVM uzyskuje siÍ poprzez moøliwoúÊ pod≥πczania (binding) w≥aúciwoúci z zewnÍtrznych klas. Ten typ podejúcia umoøliwia szybkie tworzenie elementÛw programu.
\subsubsection{T-SQL}
Jest to krÛtkie okreúlenie Transaction-SQL, ktÛre jest rozwiniÍciem standardowego SQL. JÍzyk SQL zosta≥ stworzony specjalne dla relacyjnych baz danych opracowa≥a go na poczπtku lat 70 firma IBM \cite{bazy}, jest to standard otwarty. WspÛ≥czeúnie jest on wykorzystywany przez wiÍkszoúÊ firm do tworzenia zapytaÒ bazodanowych.[przipis] Wiele firm dodaje swoje usprawnienia w zaleønoúci, co odczuje za stosowne by rozszerzyÊ moøliwoúÊ i przyspieszyÊ pracÍ baz danych np. PL/SQL firmy Oracl.  
T-SQL jest jÍzykiem transakcyjny, polega na wykonywanie operacji, jeúli operacja zosta≥a zaakceptowana to nastÍpuje zapis do bazy, moøna to porÛwnaÊ do przelewÛw bankowych zabranie z jednego konta i przelaniu na drugie konto, jeúli na pierwszym koncie jest suma potrzebna do przelewu. W przeciwnym wypadku przelew nie nastÍpuje tak jak zapis do bazy, jeúli dane bÍdπ nieprawid≥owe. Umoøliwia rÛwnieø tworzenie zmiennych, pÍtli jak rÛwnieø instrukcji warunkowych.

\subsection{Wykorzystane narzÍdzia}
\subsubsection{Visual Studio 2013}
Do napisania projektu zosta≥ wykorzystanych Visual Studio w wersji 2013 \cite{VS} edycja Professional. Jest to bardzo rozbudowany kompilator ze zintegrowanym debuggerem. Wspiera on bardzo wiele jÍzykÛw programowania miedzy innymi JavaScript, HTML, C\#, VB, XAML, C++.  Standardowym úrodowiskiem dla technologii jakimi sπ WPF .NET/C\#  jest Visual Studio. DziÍki wbudowanym mechanizmom istnieje rÛwnieø moøliwoúci ich rozszerzania poprzez napisanie dodatkÛw z wykorzystaniem SDK. Moøna rÛwnieø pobraÊ juø gotowe rozszerzenia z Visual  studio gallery  \cite{VSG} stworzonych przez innych uøytkownikÛw zrzeszonych wúrÛd produktÛw firmy Microsoft. Wbudowanym mechanizmem jest debugger, ktÛry umoøliwia úledzenie programu krok po kroku pozwala to na szybkie znajdowanie b≥ÍdÛw w kodzie i ich naprawÍ. NastÍpnym przydatnym mechanizmem jest system IntelliSense odpowiada on za podpowiadanie elementÛw sk≥adowych klas. Technologia to wspomagana jest rÛwnieø przez odpowiednie komentowanie kodu tak by te komentarze teø siÍ wyúwietla≥y w podpowiedzi. DziÍki temu mechanizmowi istnieje moøliwoúÊ szybszego odnajdywania poszczegÛlnych elementÛw klasy, ktÛry sπ w danym momencie wymagane. Wykorzystujπc odpowiednie udogodnienia istnieje moøliwoúÊ szybszego pisania kodu, co przek≥ada siÍ na iloúÊ kodu do napisania przez programistÍ. Kolejnym istotnym elementem z punktu widzenia projektu jest moøliwoúÊ projektowania okien w dwÛch technologiach WPF i Winforms. U≥atwia to pracÍ nad interfejsem uøytkownika, poniewaø wyeliminowana jest koniecznoúÊ ciπg≥ego uruchamiania pisanego programu. Zawiera rÛwnieø wiele predefiniowanych elementÛw dla tworzonego wyglπdu miedzy innymi pola tekstowe, przyciski. Wykorzystujπc technikÍ drag-and-drop moøna w ≥awy sposÛb ustawiaÊ elementy w wybranym przez siebie miejscu.
[TODO  zrobiÊ zrzut przedstawiajπc interfejs]

\subsubsection{SQL Server Management Studio}
W trakcie prac nad projektem wykorzystano darmowe narzÍdzie do zarzπdzania bazπ danych SQL Server Management Studio 2012 Express \cite{SQL Server Management Studio Express} wynika to z istniejπcej infrastruktury opartej na rozwiπzaniach Microsoftu, co u≥atwi≥o nam pracÍ i proces projektowania ca≥ej bazy danych. DziÍki przejrzystemu interfejsowi uøytkownika, moøna w bardzo ≥atwy sposÛb tworzyÊ nawet bardzo skomplikowane struktury, bez koniecznoúci znajomoúci jÍzyka tworzπcego bazÍ danych.  Program ten u≥atwi≥ tworzenie wymaganej przez sieÊ hotelowπ bazy danych. Istnieje rÛwnieø moøliwoúÊ generowania skryptÛw, ktÛrych zadaniem jest odtworzenie ca≥ej struktury bazy danych. W programie jest rÛwnieø moøliwoúÊ tworzenia diagramÛw: wszystkich jak rÛwnieø wybranych tabel. Te moøliwoúci przedstawia rysunek  \ref{rys:interfejsSQL} Umoøliwia to diagnozowanie problemu braku po≥πczeÒ niektÛrych tabel z resztπ struktury. 

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{diagrambazy.jpg}
    \caption{Interfejs SQL Server Management Studio Express, èrÛd≥o: Opracowanie w≥asne.}
     \label{rys:interfejsSQL}
\end{figure}
Wykorzystujπc wbudowane mechanizmy moøliwe jest ≥atwe wpisywanie poczπtkowych danych takich jak: uøytkownicy systemu, ceny produktÛw, ich edycja na poziomie bazy. Umoøliwia to sprawdzenie, czy baza dzia≥a zgodnie oczekiwaniami. W ten sposÛb moøna úledziÊ dzia≥anie naszego programu w trakcie pracy. SprawdziÊ moøna czy wszystkie elementy prawid≥owo dzia≥ajπ i czy w poprawny sposÛb jest zapisywana dana pozycja.   
\subsubsection{Trello}

\subsubsection{SourceTree + GitHub}

\subsubsection{ReSharper}
\subsubsection{Jenkins}
\subsection{Biblioteki zewnÍtrzne}
\subsubsection{Extended WPF Toolkit}
\subsubsection{PDFsharp \& MigraDoc}
\section{Implementacja}
\subsection{Architektura aplikacji}
\subsubsection{Wzorce architektoniczne oprogramowania}
\subsubsection{Zastosowany wzorzec architektoniczny ñ MVVM}
\subsubsection{Model aplikacji}
\subsection{Architektura bazy danych}
\subsubsection{Definicja bazy danych}
Bazy danych moøna porÛwnaÊ do archiwum firmy gdzie sπ przechowywane wszelakie projekty i dane osobowe. Tabelπ w kontekúcie tego przyk≥adu jest pojedynczy segregator zawierajπcy dane o identycznej tematyce. Tabela sk≥ada siÍ z wierszy dalej zwanych rekordami i kolumn. Rekord tworzy spÛjnπ ca≥oúÊ tak jak dane jednej osoby, a kolumny to sπ poszczegÛlne dane typu imiÍ nazwisko pesel itp.. Tak jak pesel jest unikatowy dla osoby w firmie tak klucz g≥Ûwny w tabeli teø musi byÊ unikatowy. Po≥πczenie dwÛch segregatorÛw poprzez na przyk≥ad pesel danej osoby to w drugim segregatorze nazywa siÍ kluczem obcym, a samo po≥πczenie relacjπ. RozrÛøniamy kilka relacji:
\begin{enumerate}
  \item Jeden do, wielu kiedy jedna koszulka w segregatorze ≥πczy siÍ z wieloma koszulkami w drugim.
  \item Jeden do jednego wystÍpuje wtedy, kiedy jedna teczka ≥πczy siÍ tylko z teczkπ innπ w pojedynczy sposÛb.
  \item Wiele do wielu wystÍpuje wtedy, kiedy jedna koszulka z jednego segregatora odpowiada wielu w drugim i na odwrÛt.
\end{enumerate}

W projekcie zosta≥a wykorzystana baza relacyjna, ktÛra dzia≥a na powyøszym przyk≥adzie. Waønym z punktu widzenia projektowania aplikacji bazodanowej jest odpowiednie zaprojektowanie struktury tabel i po≥πczeÒ miedzy nim. Nie moøna lekcewaøyÊ tego procesu. Gdy siÍ üle zaprojektuje bazÍ mogπ wyniknπÊ w pÛüniejszym czasie problemy z jej dalszym rozwojem. Istnieje jeszcze gorszy scenariusz, gdy w trakcie dalszych prac baza danych nie bÍdzie spe≥nia≥a swojego zadania. Efektem üle zaprojektowanej bazy danych moøe byÊ d≥ugoúÊ wykonywanych zapytaÊ jak i bardzo duøa z≥oøonoúÊ. Wiπøe siÍ to z koniecznoúciπ przeprojektowania od poczπtku ca≥ej bazy lub starania siÍ w programie ukryÊ te niedomagania.

\subsubsection{MS-SQL ñ Zastosowany system zarzπdzania bazπ danych}
Z racji wykorzystania w projekcie baz danych istnia≥a koniecznoúÊ uruchomienia serwera bazodanowego. W sieci hotelowej wykorzystane sπ technologie Microsoftu. Produktem tej firmy zwiπzanym z powyøszπ tematykπ jest  serwer z rodziny  MS-SQL. Serwer ten umoøliwia tworzenie baz danych dwÛch typÛw relacyjny jak i nierelacyjnych. Tworzenie baz danych moøe siÍ odbywaÊ w dwojaki sposÛb:
\begin{enumerate}
	\item	SQL Server Management Studio, ktÛry jest nak≥adkπ graficznπ
	\item	T-SQL. 
\end{enumerate}
DziÍki wbudowanym typom danych zabezpiecza to przed wpisaniem nieprawid≥owej wartoúci w danym miejscu 

\subsubsection{Budowa bazy danych uøytej w projekcie}
BazÍ, ktÛra zosta≥a wykorzystana w projekcie moøna podzieliÊ na dwie g≥Ûwne czÍúci: czÍúci zawierajπcπ domyúlne wartoúÊ na przyk≥ad cennik gastronomiczny, wyposaøenia sali w dalszej czÍúci zwane s≥ownikami i czÍúÊ powiπzana z tworzonπ propozycjπ cenowπ. Tabele s≥ownikowe nie sπ z niczym powiπzane nawet same ze sobπ. Taki podzia≥ tabel na dwa osobne zbiory zosta≥ spowodowany bezpieczeÒstwem. Jeúli istnia≥aby relacja ≥πczπca te dwie tabele to zmiana wartoúÊ w tabeli s≥ownikowej powodowa≥aby zmianÍ cen produktÛw w starszych propozycja. Efektem unikniÍcia tego typu problemÛw jest rozdzielenie na dwie odseparowane czÍúci.  Gdyby tak nie by≥o wtedy moøliwoúÊ odtworzenia starej propozycji cenowej by≥aby niemoøliwa, co jest efektem niepoøπdanym z punktu widzenia dzia≥ania aplikacji.  

Drugi cz≥on bazy danych stanowiπ tabele zwiπzane z tworzonπ propozycjπ cenowπ. Sπ one podzielone w logiczny sposÛb uwzglÍdniajπc podzia≥ przyk≥adowej propozycji cenowej przedstawione przez sieÊ hotelowπ na przyk≥ad: produkty gastronomiczne, wyposaøenie sali, szczegÛ≥y rezerwacji.  Podzia≥ taki uwzglÍdnia moøliwoúÊ dalszego rozwoju aplikacji.

[TODO  zrobiÊ schemat bazy danych]

\subsection{Komunikacja bazy danych z projektem programistycznym}
\subsubsection{NarzÍdzia ORM}
\subsubsection{Zastosowane oprogramowanie mapowania obiektowo relacyjnego ñ Entity Framework}
\subsubsection{Dostosowanie Entity Framework do wymagaÒ zwiπzanych ze wzorcem MVVM}
\subsubsection{Uøycie bazy danych ze strony projektu C\#}
\subsection{Automatyzacja wydawania kolejnych wersji programu}
\subsubsection{Continuous Integration ñ definicja}
\subsubsection{Continuous Deployment ñ definicja}
\subsubsection{Continuous Delivery ñ definicja}
\subsubsection{Schemat budowania programu}
\section{Specyfikacja zewnÍtrzna}
\subsection{Logowanie}
\subsection{Zarzπdzanie kontem sprzedawcy oraz administratora  (obs≥uga)}
\subsection{Tworzenie nowej propozycji cenowej}
\subsubsection{Opis klienta}
\subsubsection{SzczegÛ≥y rezerwacji}
\subsubsection{Us≥ugi gastronomiczne}
\subsubsection{Us≥ugi noclegowe}
\subsubsection{Us≥ugi dodatkowe i forma p≥atnoúci}
\subsection{Edycja istniejπcej propozycji cenowej}
Edycja istniejπcej propozycji cenowej odbywa siÍ poprzez zaznaczenie w oknie g≥Ûwny programu wybranej propozycji cenowej, a nastÍpnie z menu wybrania "Edytuj" moøna to zaobserwowaÊ na rysunku \ref{rys:editpro} . Uøytkownik zostanie przeniesiony do okna tworzenia nowej propozycji, ale juø z wype≥nionymi wczeúniej polami. Sprzedawca ma moøliwoúÊ dodawania nowych produktÛw a usuwanie odbywa siÍ poprzez wybranie pustego pola na liúcie rozwijalnej.
\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{editpro.jpg}
    \caption{Edycja propozycji cenowej, èrÛd≥o: Opracowanie w≥asne.}
     \label{rys:editpro}
\end{figure}

\subsection{Tworzenie pliku PDF istniejπcej propozycji cenowej}
\subsection{Modyfikacja kont uøytkownikÛw/sprzedawcÛw}
\subsubsection{Dodawanie konta}
\subsubsection{Edycja konta}
\subsubsection{Usuwanie konta}
\subsection{Modyfikacja s≥ownikÛw cenowych}
Modyfikacja s≥ownikÛw cenowych odbywaÊ siÍ moøe tylko z poziomu administratora. Z menu naleøy wybraÊ ÑEdytuj s≥ownik". Zostanie otwarte nowe okno, gdzie moøna wybraÊ typ s≥ownika, ktÛry bÍdzie edytowany. Okno te moøna zaobserwowaÊ na rysunku \ref{rys:editdic}. Jedynie w przypadku gastronomi istnieje moøliwoúÊ wybrania z grupy produktÛw. Edycja nastÍpuje poprzez wpisywanie wartoúci w poszczegÛlnych komÛrkach tabeli w zaleønoúci, ktÛrπ pozycjÍ chce siÍ edytowaÊ. Wciskajπc przycisk ÑENTERî nastÍpuje zapis edytowanego wiersza do bazy danych. Istnieje rÛwnieø moøliwoúÊ dodawania nowych pozycji. W ostatnim pustym wierszu tabeli naleøy wype≥niÊ wszystkie komÛrki, by mÛc dodaÊ do bazy. Odúwieøenie tabeli w przypadku dodania nowego produktu nastÍpuje po ich prze≥πczeniu.  
 \begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{editdic.jpg}
    \caption{Edycja propozycji cenowej, èrÛd≥o: Opracowanie w≥asne.}
     \label{rys:editdic}
\end{figure}  
\section{Specyfikacja wewnÍtrzna}
\subsection{Logowanie}
\subsubsection{Funkcja haszujπca}
\subsubsection{SHA-2}
\subsubsection{Pierwsze logowanie}
\subsection{Konto administratora i uøytkownika ñ ListView}

Uøytkownik moøe oglπdaÊ swoje propozycje ich iloúÊ jak i z jak firmami zwiπzana jest dana propozycja cenowa. Do tego celu nie moøna w bezpoúredni sposÛb wykorzystaÊ bazy danych lecz zosta≥a stworzona warstwa poúrednia w postaci klasy AdminProposition. Klasa ta zawiera pola wymagane do wyúwietlenia propozycji cenowej w postaci imiÍ nazwisko osoby odpowiedzialnej, status, jeúli dana propozycja cenowa jest dla firmy to firmÍ. Wykorzystujπc polecenia LINQ sπ pobierane dane z bazy danych i wykorzystujπc wbudowane mechanizmy, jest tworzona lista propozycji z wymaganymi polami. Przedstawia to  listing\ref{listing:Wyciπganie}
\begin{lstlisting}[caption= {Polecenie wyciπgajπce wszystkie propozycje uøytkownika} \label{listing:Wyciπganie}]
 var myProposition = (from prop in _ctx.Proposition
                            from user in _ctx.Users 
                            where user.Id == _userId		
                            where prop.Id_user == _userId 
                            // szuka propozycji uøytkownika zalogowanego
                            select new AdminProposition
                            {
                                PropositionId = prop.Id,
                                UserFirstName = user.Name,
                                UserSurname = user.Surname,
                                CustomerFullName = prop.PropClient.CustomerFullName,
                                CompanyName = prop.PropClient.CompanyName,
                                UpdateDate = prop.UpdateDate,
                                Status = prop.Status
                            }).ToList();
            PropositionsList = myProposition; 
//przypisanie do listy propozycji w prawid≥owej formie do wyúwietlenia
\end{lstlisting}
Administrator ma rÛwnieø dodatkowπ moøliwoúÊ wybierania propozycji danego uøytkownika. Wykorzystujπc moøliwoúci jÍzyka LINQ tworzona jest lista wszystkich uøytkownikÛw majπcych jakiekolwiek propozycje cenowe i przypisanie ich do ComboBox. Proces przypisywania prezentuje listing \ref{listing:Wyciπganie} Wraz z wyborem uøytkownika z tej listy nastÍpuje odúwieøenie ListView z propozycjami. 
\begin{lstlisting}[caption= {Polecenie wyciπgajπce wszystkie propozycje uøytkownika} \label{listing:Wyciπganie}]
 var userlist = (from s in _ctx.Users
                     where s.Proposition.Any()
                     select s).ToList();
            userlist.Add(new Users()); 
 //dodanie pustego uøytkownika by mÛc wyúwietliÊ wszystkie propozycje
            UsersList = userlist;

\end{lstlisting}

Edycja propozycji w obydwu przypadkach odbywa siÍ w ten sam sposÛb poprzez wybranie propozycji z ListView nastÍpuje przypisanie identyfikatora z bazy danych do zmiennej i wyszukanie wszystkich elementÛw danej propozycji. Z kolei wype≥niane sπ wszystkie pola, ktÛre zosta≥y zaznaczone. 

\subsection{Tworzenie propozycji cenowej}
\subsection{Edycja s≥ownikÛw oraz kont uøytkownikÛw}
\subsubsection{DataGridView a dynamiczna komunikacja z Bazπ danych}
\subsection{Tworzenie szablonu PDF propozycji cenowej}
\section{Perspektywy rozwoju oprogramowania}

Lorem Ipsum generator (\texttt{http://lipsum.pl/index.php});

Moskalom przez konar b≥ysnÍ≥o jako po zadzwonieniu na wzmiankÍ Warszawy rzek≥, podnios≥szy g≥owÍ: Pan úwiata wie, øe gotyckiej sπ nasze spraw bernardyÒskie. cÛø by znaczyÊ w poÒczochach, ze úwiecami w uczciwoúci, w oknie sta≥ patrzπc, dumajπc wonnymi powiewami kwiatÛw oddychajπc oblicze aø do dworu. Tu úmiech m≥odzieøy mowÍ Wojskiego zag≥uszy≥. Wstano od dzisiaj nie dozwala≥, by tu RykÛw przerwa≥ i s≥udzy. I oglπda czule, jako úwieca przez grzecznoúÊ nie po duszy, a ja wam s≥uøyÊ, moje panny cÛrki choÊ suknia krÛtka, oko paÒskie konia tuczy. Wojski towarzystwa nam siÍ damom, starcom i tuø nad b≥Íkitnym Niemnem rozciπgnionych. Do zobaczenia! tak gadaÊ: CÛø z≥ego, øe tamuje progresy, øe mi wybaczy, Øe w poÒczochach, ze srebrnymi klamrami trzewiki peruka z nowych goúci. W takim Litwinka tylko siÍ jak mnich na prawo, kozio≥ka, z brabanckich koronek poprawia≥a, to mÛwiπc, øe odg≥os trπbki i ubiory. By≥a to mÛwiπc, øe jacyú Francuzi wymowny zrobili wynalazek: iø ludzie sπ architektury. ChoÊ SÍdzia tuø to mÛwiπc, øe przeszkadza kulturze, øe jacyú Francuzi wymowny zrobili wynalazek: iø ludzie sπ architektury. ChoÊ SÍdzia wie, øe nauczyciel ≥adny i dwiestu.

%% UWaga na \newlineTekst oraz \newlineSpis. Moøna teø uøyÊ \newline, dzia≥a jak \newlineSpis\newlineTekst
\section[Tytu≥ drugiego rozdzia≥u. Bardzo d≥ugi \ldots]
        {Tytu≥ drugiego rozdzia≥u. \newlineTekst Bardzo d≥ugi tytu≥. \newlineTekst
          Jego \newlineSpis formatowanie jest trudniejsze}

Tu jest wnÍtrze rozdzia≥u drugiego.          



MÛwiπc, Podkomorzemu úcisnπ≥ za rarogiem zazdroszczono domowi, przed nim leøy Fedon i SuwarÛw w naukach mniej krzykliwy i wionÍ≥a ogrodem przez Niemen rzek≥: Dziú, nowym zwyczajem my na konikach ma≥e øarciki umia≥ komponowaÊ iøby je wicher rozerwie i dziwniejsze od kilku dzieje chciano przeczyÊ chwa≥y. WiÍc do z≥otego run on Pana MÛwiπc, Podkomorzemu úcisnπ≥ za rarogiem zazdroszczono domowi, przed nim dla zabawki Bo nie rozwity, lecz latem nic nie jest obora. Dozoru tego dnia powiada≥. Dobrze, mÛj Tadeuszu, øeú siÍ Soplica. wszyscy siedli i jelenie rogi z Rymszπ, Rymsza z pola. Tak kaøe u Niemna odebra≥ wiadomoúÊ. moøe teø same portrety na filarach, pod≥oga wys≥ana kamieniem, åciany bez rÍki lub papugπ w PaÒskim pisano zakonie i opisujÍ, bo tak nazywano m≥odzieÒca, ktÛry teraz za nim spostrzeg≥ siÍ, serce mu jak wiúnie bliüniÍta. U tej znalaz≥ podobne oczy, usta, lica. w czasie wojny otoczony chmurπ pu≥kÛw, tysiπcem dzia≥ zbrojny wprzπg≥szy w koÒcu úrÛd biesiadnikÛw siedzia≥ s≥ucha≥ zmruøywszy oczy, usta, lica. w sieni siad≥ przy jego wiernym ludem! Jak go pilnowa≥ i oczy wko≥o obraca≥ ostrÛøne. Gdy siÍ chlubi a zajπc jak.

\dodatek{MÛj specjalny dodatek}

Tu treúÊ dodatku. ZwrÛÊmy uwagÍ na sposÛb numerowania dodatku, 
moøliwa jest zmiana numerowania, patrz wyjaúnienia.
          
%% to wpisuje siÍ do spisu treúci, ale bez numeru rozdzia≥u,
%% moøna teø uøywaÊ \dodatek{Tytu≥}, ktÛry jest numerowany, ale inaczej niø rozdzia≥y.
\dodatkowo{Rysunki}



\dodatkowo{Programy}

Tu programy

\begin{verbatim}
#include <stdio.h>

int main()
{
   printf("Hello world\n");
}
\end{verbatim}

\noindent
Oraz 

\bigskip

\vrule\hspace{10pt}\begin{minipage}{10cm}
\begin{verbatim*}
<?php
   echo "test=$test";
?>
\end{verbatim*}
\end{minipage}


\begin{thebibliography}{12}

% wstÍp
\bibitem{LiczbaHoteli} http://www.wykresy.net/liniowe/liczba-hoteli-w-polsce-ostatnie-12-lat.html

% trello
\bibitem{Kanban}
KrasiÒski M.: \textsl{Nauki o zarzπdzaniu}, Wydawnictwo Uniwersytetu Ekonomicznego we Wroc≥awiu, Wroc≥aw, 2013, str.24-32

\bibitem{PlatformyTrello} 
https://trello.com/platforms

% ReSharper
%znalesc ksiazke w ktorej jest opis .NET
\bibitem{.NETOpis}
Chappell D.: \textsl{Understanding .NET (2nd Edition)}, Wydawnictwo Addison-Wesley Professional, POPRAWI∆

\bibitem{MartwyKod}
Martin R.C.: \textsl{Czysty kod. PodrÍcznik dobrego programisty}, Wydawnictwo Helion, Gliwice 2014

\bibitem{ReSharperFunkcje} 
https://www.jetbrains.com/resharper/features/

\bibitem{MicrosoftPublicLicence} 
https://opensource.org/licenses/MS-PL

%wpf extended - na razie brak

% galasoft mvvm

%Nazwisko I. \textsl{tytu≥}, miasto, rok
\bibitem{nazwa} Jakaú pozycja literatury
\bibitem{SQL Server Management Studio Express}
https://www.microsoft.com/en-us/download/details.aspx?id=29062

%7.12.2012
\bibitem{iloscFirm}
http://stat.gov.pl/obszary-tematyczne/podmioty-gospodarcze-wyniki-finansowe/przedsiebiorstwa-niefinansowe/male-i-srednie-przedsiebiorstwa-niefinansowe-w-polsce-w-latach-2009-2013,22,1.html

\bibitem {SystemERP}
Jerzy Kisielnicki, Ma≥gorzata PaÒkowska, Henryk Sroka.:\textsl{Zintegrowane systemy informatyczne. Dobre praktyki wdroøeÒ systemÛw klasy ERP}, Wydawnictwo Naukowe PWN, 2012
\bibitem {ProfitCRM}
http://www.profitcrm.pl/crm
\bibitem {AsystentCRM}
http://meteoryt.pl/
\bibitem {Gestor}
https://www.insert.com.pl

\bibitem {WPF}
 Adam Nathan \textsl{WPF 4.5. KsiÍga eksperta}, Wydawnictwo Helion , 2015
 \bibitem {baza}
	Jeffrey D. Ullman, Jennifer Widom  \textsl{Podstawowy kurs systemÛw baz danych. Wydanie III},
	 Wydawnictwo Helion , 2011
\bibitem {VS}
https://www.visualstudio.com/pl-pl/downloads/download-visual-studio-vs.aspx
\bibitem {VSG}
https://visualstudiogallery.msdn.microsoft.com
\end{thebibliography}


\listoffigures

\end{document}
