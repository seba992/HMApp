\documentclass[twoside]{projektInzynierskiMS}
\usepackage{polski}
\usepackage[cp1250]{inputenc}
%\usepackage{amsmath}
\usepackage{listings}
%\usepackage{xcolor}
\usepackage{color}
\usepackage{graphicx}
%\drukJednostronny
\usepackage{tabto}

\renewcommand{\lstlistingname}{Kod Ÿród³owy}
\renewcommand\lstlistlistingname{Kody Ÿród³owe}
\renewcommand*{\refname}{Bibliografia}

\definecolor{bluekeywords}{rgb}{0,0,1}
\definecolor{greencomments}{rgb}{0,0.5,0}
\definecolor{redstrings}{rgb}{0.64,0.08,0.08}
\definecolor{xmlcomments}{rgb}{0.5,0.5,0.5}
\definecolor{types}{rgb}{0.17,0.57,0.68}

\usepackage{listings}
\lstset{language=[Sharp]C,
captionpos=b,
showtabs=false,
breaklines=true,
showstringspaces=false,
breakatwhitespace=true,
escapeinside={(*@}{@*)},
commentstyle=\color{greencomments},
morekeywords={partial, var, value, get, set},
keywordstyle=\color{bluekeywords},
stringstyle=\color{redstrings},
basicstyle=\ttfamily\small
}


%% tytu³ promotor i autor (\title to komenda standardowa)
\title{Projekt i wykonanie aplikacji bazodanowej wspomagaj¹cej pracê wybranej sieci hotelowej}
\promotor{dr. Jaros³aw Karcewicz}


%% ka¿dy autor musi mieæ 4 argumenty: imiê nazwisko, nr albumu, procent wk³adu, opis wk³adu
\autor{£ukasz Lis}{112233}{1} {~7.5 strony na 13.12.2015r.}
	
\autor{Sebastian Nalepka}{225265}{3} {~23 strony na 13.12.2015r.}

\autor{Mateusz Ogiermann}{226591}{0} {~9 stron na 13.12.2015r.}	
	


%% dedykacja mile widziana
\dedykacja{To jest\\dedykacja}
%\NumeryNaPoczatku
%% numeracja wzorów tu w³¹czona typu (1.2.3), ta druga to typu (1.2), a domyœlnie typu (1)
%\subsectionWzory
% \sectionWzory  

%\rozdzialy


%\literowaNumeracjaDodatkow %% w³¹czy numeracjê dodatków literami
%\rzymskaNumeracjaDodatkow  %%w³¹czy numeracjê dodatków liczbami rzymskimi

%% wy³¹czenie wyjaœnieñ:
\bezWyjasnien

%% standardowe komendy \newtheorem  dzia³aj¹ jak w oryginale
\newtheorem{tw}{Twierdzenie}[subsection]
\newtheorem{twa}{Twierdzenie}[section]
\newtheorem{dd}{Definicja}[subsection]

\begin{document}
\TabPositions{0.75cm}


Obecna sytuacja rynkowa zwi¹zana z istnieniem du¿ej iloœci firm w zakresie ka¿dej bran¿y wymusza na przedsiêbiorcach ci¹g³e zwiêkszanie swojej atrakcyjnoœci oraz konkurencyjnoœci w celu zdobycia potencjalnego klienta. W realizacji powy¿szego zadania konieczne jest wdra¿anie nowoczesnych metod umo¿liwiaj¹cych miêdzy innymi obni¿enie kosztów pracy, co wprost przek³ada siê na ni¿sz¹ cenê produktu koñcowego. Ni¿sza cena dla klienta jest jednym z najwa¿niejszych elementów, który determinuje wybór konkretnego us³ugodawcy. Aspekt ten dotyczy tak¿e bran¿y hotelarskiej, która w sposób bezpoœredni dotyczy naszej pracy.
	Liczba hoteli w Polsce od kilkunastu lat nieprzerwanie roœnie \cite{LiczbaHoteli}. Implikuje to koniecznoœæ wzmo¿onej walki o klienta w celu utrzymania siê na rynku. Obni¿enie cen us³ug wynajmu pokoi, sal konferencyjnych oraz cateringów przy zachowaniu odpowiedniego poziomu dochodów jest problemem, z którym zmaga siê ka¿da sieæ hotelowa. Przedsiêbiorcy przeœcigaj¹ siê w znajdowaniu coraz to nowszych i efektywniejszych rozwi¹zañ, które maj¹ na celu rozwi¹zanie owego problemu. W XXI wieku du¿¹ pomoc¹ w tym zakresie okazuje siê informatyzacja.

\section{Geneza projektu}

Podczas przeprowadzania transakcji dotycz¹cej organizacji szkolenia w jednej z sieci hotelowych, dostrze¿ony zosta³ potencjalny problem wynikaj¹cy z manualnego operowania wszelkimi danymi przez pracowników dzia³u sprzeda¿y. Pracownicy Ci w czasie kontaktu z klientem maj¹ za zadanie ustalenie wszelkich wartoœci cenowych us³ug wybranych przez klienta. Us³ugi te bezpoœrednio zwi¹zane s¹ z typem wydarzenia, które klient chce zorganizowaæ. Przewa¿nie s¹ to wszelkiego rodzaju konferencje, kilkudniowe szkolenia firmowe, ale tak¿e imprezy weselne, urodzinowe, czy spotkania rodzinne. Przez wzgl¹d na ró¿n¹ specyfikê powy¿szych przedsiêwziêæ sieæ hotelowa dysponuje szerok¹ gam¹ us³ug z nimi zwi¹zanych. 

W czasie tworzenia przez sprzedawcê propozycji cenowej organizowanego wydarzenia, klient ma mo¿liwoœæ wyboru odpowiedniej dla jego potrzeb sali konferencyjnej lub bankietowej wraz z jej dodatkowym wyposa¿eniem, ustalenia aspektów gastronomicznych, takich jak liczba i rodzaj posi³ków oraz napojów, a tak¿e wyborem odpowiedniego typu pokoju hotelowego. Po wstêpnym wyborze zakresu us³ug, elementy te uzupe³niane s¹ o liczbê osób, które bêd¹ w wydarzeniu uczestniczyæ, a tak¿e iloœæ dni jego trwania. Kolejnym etapem jest negocjacja rabatów oraz finalnie ustalenie formy zap³aty za organizowane przedsiêwziêcie. Aktualnie operacja ta wraz z procesem tworzeniem dokumentu propozycji cenowej przeprowadzana jest za pomoc¹ aplikacji Microsoft Excel jak równie¿ w wersji papierowej. Obydwie metodologie generuj¹ liczne problemy, które bezpoœrednio wp³ywaj¹ na zwiêkszenie kosztów generowanych przez pracowników, a co za tym idzie ceny oferowanych us³ug. Pierwszy problem odnosi siê do aspektu utrudnienia aktualizacji danych, który jest nieod³¹cznym elementem bran¿y. Ceny pokoi hotelowych ulegaj¹ czêstym modyfikacjom oraz uzale¿nione s¹ od sytuacji rynkowej, organizowanych okolicznych wydarzeñ rozrywkowych i kulturalnych oraz samego faktu wolnej ich iloœci w danym czasie. Analogicznie sytuacja przedstawia siê w przypadku produktów gastronomicznych oraz pozosta³ych wynajmowanych pomieszczeñ.

Aktualnie wszelkie modyfikacje cenników pokoi hotelowych, sal mo¿liwych do wynajêcia oraz dostêpnych towarów dokonywane s¹ przez menad¿era sprzeda¿y, który za poœrednictwem poczty elektronicznej przekazuje uaktualnione wersje arkuszy kalkulacyjnych oraz listy cen okreœlonym sprzedawcom. Czêste zmiany zobowi¹zuj¹ pracowników dzia³u sprzeda¿y do ci¹g³ej kontroli skrzynki elektronicznej oraz powoduj¹ presjê spowodowan¹ posiadaniem potencjalnie nieaktualnych danych. Zaawansowane arkusze kalkulacyjne wykonane w aplikacji Excel podatne s¹ na b³êdy ludzkie, wymuszaj¹ na pracownikach dobr¹ znajomoœæ oprogramowania oraz umiejêtnoœæ jego obs³ugi, co z kolei niekorzystnie przek³ada siê na nowych pracowników oraz pracodawcê, który zobowi¹zany jest przeprowadzaæ d³ugie i kosztowne szkolenia w tym zakresie.
Kolejnym dostrze¿onym problemem jest zagadnienie czasoch³onnoœci wyszukiwania danych dotycz¹cych produktów znajduj¹cych siê na hotelowej restauracji i ich cen. Pracownik otrzymuje rozbudowan¹ listê produktów wraz z przyporz¹dkowanymi im cenami i we w³asnym zakresie zobligowany jest znaleŸæ interesuj¹c¹ go pozycjê w czasie przygotowywania propozycji cenowej. 

Dostrzegaj¹c powy¿sze problemy zdecydowano siê wykonaæ dedykowan¹ aplikacjê bazodanow¹, której celem jest ich rozwi¹zanie. Za³o¿ono, ¿e konieczne by by³o, aby ka¿dy ze sprzedawców posiada³ mo¿liwoœæ uruchomienia na swoim s³u¿bowym komputerze programu, który dziêki po³¹czeniu z baz¹ danych i wykorzystaniu jej funkcjonalnoœci umo¿liwi³by przyspieszenie procesu przeprowadzania transakcji z klientem poprzez automatyczn¹ aktualizacjê cenników oraz przedstawienie listy produktów gastronomicznych w skategoryzowany sposób. Dziêki przechowywaniu wszystkich propozycji cenowych w bazie danych, zanika³aby koniecznoœæ samodzielnej ich kategoryzacji i dbania o bezpieczeñstwo na lokalnym komputerze. Umo¿liwi³oby to pracownikom pracê na ró¿nych maszynach, co w znaczny sposób zwiêkszy³oby ich elastycznoœæ.

Kolejnym atutem przedstawionego rozwi¹zania by³oby umo¿liwienie kierownictwu z poziomu kont administratorskich kontroli pracowników poprzez zdalny wgl¹d w przygotowywane przez nich propozycje cenowe, a co za tym idzie ustalanych z klientem cen oraz zni¿ek. Menad¿er sprzeda¿y za pomoc¹ swojego uprzywilejowanego konta posiada³by równie¿ mo¿liwoœæ aktualizacji odpowiednich tabel danych, dziêki czemu zmiany natychmiastowo by³yby widocznie na kontach sprzedawców. Zmiany te dotyczy³yby mo¿liwoœci modyfikacji cen oferowanych us³ug i produktów oraz kontroli sk³adu pracowniczego poprzez funkcjonalnoœæ dodawania, usuwania a tak¿e modyfikacji ich kont. 

\section{Analiza przedwdro¿eniowa}


\section{Istniej¹ce rozwi¹zania konkurencyjne}
Wraz ze wzrostem liczby firm \cite{iloscFirm} dzia³aj¹cych w Polsce istnieje koniecznoœæ lepszego, szybszego zarz¹dzania. Wi¹¿e siê to z rozwojem informatyzacji. Mo¿na w ten sposób zautomatyzowaæ wiele procesów w firmie miedzy innymi: zarz¹dzanie magazynem, kontrolê sprzeda¿y, zapotrzebowanie przedsiêbiorstwa na ró¿ne produkty. Do tego celu wdra¿ane s¹ zintegrowane systemy informatyczne, których zadaniem jest po³¹czenie wszystkich elementów przedsiêbiorstwa, w jeden scentralizowany system. Wykorzystuje siê do tego oprogramowania klasy ERP (ang. enterprise resource planning – ERP)\cite{SystemERP}. W sk³ad takiego oprogramowania mo¿e wchodziæ wiele modu³ów: finansowoœæ, stany magazynowe, kontakt z klientem, w zale¿noœci, co w danym przedsiêbiorstwie jest wymagane. Wymogiem takiego systemu jest by wszystkie modu³y by³y niezale¿ne, poniewa¿ ka¿da firma nie potrzebuje ich wszystkich, ale musz¹ siê umieæ z sob¹ komunikowaæ by móc w lepszy sposób zarz¹dzaæ. W wypadku kontaktu z klientem wprowadza siê systemy, które sprawnie obs³uguj¹ sprawy zwi¹zane z reklamacjami, wsparciem technicznym i innymi rzeczami zwi¹zanymi z jego obs³ug¹. Z tym zwi¹zane jest wystawianie propozycji cenowej. Jest to proces czasoch³onny ze wzglêdu na koniecznoœæ aktualizowania cenników, mo¿liwego wyposa¿enia sal i innych spraw zwi¹zanych z organizowanym wydarzeniem. Modu³ CRM(ang. customer relationship management – CRM), który wspomaga proces kontaktu z klientem zawiera komponent wspomaganie procesu wystawiania propozycji. Komponent ten nie tylko automatyzuje proces wystawiania propozycji cenowej, ale jest równie¿ odpowiedzialny, za sprzeda¿ oferowanych towarów i us³ug. W nastêpnej czêœci tego rozdzia³u przedstawiono ró¿ne systemy CRM, których istnieje wersja darmowa.

Do sprawdzenia dostêpnych rozwi¹zañ zosta³y wytypowane trzy program, które spe³niaj¹ wymagania sieci hotelowej s¹ to: ProfitCRM\cite{ProfitCRM} i Asystent CRM\cite{AsystentCRM} Gestor GT \cite{Gestor}.

\begin{itemize}
\item \textsl{Interfejs u¿ytkownika} 

\tab Wygl¹d aplikacji w niektórych przypadka pozostawia³ wiele do ¿yczenia a niektóre zaskoczy³y nietypowym interfejsem. W przypadku programu ProfitCRM interfejs u¿ytkownika jest trochê za bardzo poœciskany, co utrudnia³o znalezienie odpowiednich elementów potrzebnych w danym momencie. Najistotniejsz¹ wad¹ programu jest bardzo wolno reaguj¹cy interfejs u¿ytkownika, co utrudnia pracê. Czêsto zdarza siê, ¿e jakieœ okienko np. edycja szablonów zniknie i nie ma mo¿liwoœci robienia czegokolwiek w programie. Bardzo ma³o intuicyjnie zorganizowany jest zapis oferty do formatu PDF, poniewa¿ nie robi siê tego poprzez przycisk drukuj tylko poprzez podgl¹d dokumentu i eksportuj do PDF. Kiedy dodawany jest nowy towar lub te¿ us³uga otwiera siê nowe okno z polami, które trzeba wype³niæ. S¹ to nazwa, kod towaru. Niestety us³ugi te musz¹ mieæ jednostkê miary. W tym te¿ oknie istnieje mo¿liwoœæ dodawania zdjêæ, komentarzy i dodawania ich do grup.  Drugim ze sposobów dodawania towaru jest klikniêcie w o³ówek, który mo¿na zaobserwowaæ na rysunku
\ref{rys:rysunek olowka}

 w procesie tworzenia oferty.
  \begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{olowek.jpg}
    \caption{Sposób dodawania towaru w ofercie, ród³o: Opracowanie w³asne.}
    \label{rys:rysunek olowka}
\end{figure}

Wymagane wtedy s¹ tyko podstawowe elementy jak nazwa, kod i jednostka miary towaru. Podobny interfejs u¿ytkownika prezentuje Asystent CRM z t¹ tyko ró¿nic¹, ¿e jego przyciski s¹ zdecydowanie wiêksze i jest ich te¿ mniej w jednym oknie. Dziêki przejrzystemu interfejsowi u¿ytkownika przedstawia rysunek \ref {rys:interfejsAsystenta}

 jest bardzo prosta nawigacja w programie.
 
 \begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{IntejfejsAsystent.jpg}
    \caption{Interfejs programu Asysten CRM, ród³o: Opracowanie w³asne.}
    \label{rys:interfejsAsystenta}
\end{figure}

  Dodawanie nowych produkty odbywa poprzez magazyn lub te¿ bezpoœrednio przy tworzonej ofercie. Program Gestor GT ca³kowicie zmieni³ podejœcie do interfejsu u¿ytkownika przedstawia rysunek \ref {rys:interfejsGestor} z tych trzech jest najbardziej przejrzystym interfejsem, ale niestety ma³o intuicyjnym na przyk³ad dodawanie nowych produktów jest tutaj bardzo utrudnione i bardziej skomplikowane ni¿ w poprzednich. Wynika to z faktu ukrycia czêœci elementów w g³ównym interfejsie.
 \begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{interfejsGestor.JPG}
    \caption{Interfejs programu Gestor GT, ród³o: Opracowanie w³asne.}
    \label{rys:interfejsGestor}
\end{figure}  

\item \textsl{D³ugoœæ wersji darmowej} 

\tab Testowane programy ProfitCRM i Asystent CRM dzia³aj¹ w wersji darmowej przez 30 dni, jedynie Gestor GT w wersji darmowej mo¿na u¿ywaæ przez 45 dni. W ProfitCRM  i Gestor GT dodawany jest Microsoft SQL Server 2008. Asystent CRM jest pozbawiony dodatkowych mo¿liwoœci.

\item \textsl{Tworzenie szablonów typu dokumentów} 

\tab W programie ProfitCRM  istnieje równie¿ mo¿liwoœæ zdefiniowania w³asnego szablonu. Proces tworzenia nowego szablonu jest procesem skomplikowanym. Najlepszym rozwi¹zanie jest skopiowanie istniej¹cych w systemie szablonów, poniewa¿ ich edycja jest zablokowana.  Nastêpnie edytowanie skopiowanego. Nie powiod³o siê równie¿ wygenerowanie PDF o wygl¹dzie zbli¿onym do wygl¹du przedstawionego przez sieæ hotelow¹. Niestety w programie Asystent CRM edycja wzorów dokumentów do druku jest bardzo trudna w realizacji dla zwyk³ego sprzedawcy. Jest to spowodowane sposobem edycji. Bez znajomoœci programowania nie ma mo¿liwoœci stworzenia nowej wersji dokumentu, co utrudnia zmianê wygl¹du pod dan¹ firmê. W ostatnim przetestowanym programie czyli Gestor GT nie ma ¿adnej mo¿liwoœci edycji szablonów dokumentów.

\item \textsl{Cena}
 
\tab Koszt licencji programu ProfitCRM na jedno stanowisko pracy wynosi 736 z³ w przypadku programu Asystent CRM, w zale¿noœci od wersji od 79-369 z³. Gestor GT kosztuje 859.77z³ jest to najdro¿szy produkt z poœród wybranych
\end{itemize}

\section{Zastosowane rozwi¹zania}
\subsection{Wykorzystana technologia}

Niniejszy rozdzia³ zawiera opis technologii wykorzystanych do implementacji aplikacji. Zakres opisu obejmuje nastêpuj¹ce komponenty:

\begin{itemize}
\item \textsl{Jêzyk programowania}
\item \textsl{Silnik graficzny}
\item \textsl{Jêzyk opisu graficznego interfejsu u¿ytkownika}
\item \textsl{Jêzyk zapytañ bazy danych}
\end{itemize}

\subsubsection{.NET Framework/C\#}

.NET Framework jest platform¹ programistyczn¹ firmy Microsoft, po raz pierwszy wydany w 2002 r. S³u¿y do wytwarzania oprogramowania dla systemów operacyjnych Windows, Windows Phone, Windows Server i Microsoft Azure \cite{Clr}. G³ównymi komponentami platformy s¹:

\begin{itemize}

\item \textsl{Kompilatory jêzyków wysokiego poziomu}

\tab Umo¿liwiaj¹ kompilacjê programów napisanych w jêzykach C++/CLI, C\#, F\#, J\#, Visual Basic .NET.

\item \textsl{CLR (ang. Common Language Runtime)}

\tab CLR jest tzw. œrodowiskiem uruchomieniowym jêzyka wspólnego. Jego zadaniem jest kompilacja i uruchamianie tzw. kodu zarz¹dzanego (ang. managed code) zapisanego w standardowym jêzyku poœrednim CIL (ang. Common Intermediate Language), gwarantuj¹c funkcje wymagane do dzia³ania aplikacji \cite{Clr2}. 

\tab BCL jest standardow¹ bibliotek¹ klas, zawiera standardowe funkcjonalnoœci programistyczne takie jak definicje typów danych, odczyt i zapis plików czy obs³uga kolekcji zawarte w przestrzeni nazw \textit{System} \cite{Bcl} 

\item \textsl{FCL (ang. Framework Class Library)}

\tab FCL jest rozszerzeniem BCL, obejmuje rozszerzony zestaw bibliotek m. in. silniki graficzne Windows Forms i WPF \cite{Fcl}.

\item \textsl{CTS (ang. Common Type System)} 

\tab Wspólny system typów CTS definiuje jak u¿ywane i deklarowane s¹ typy danych w jêzykach programowania platformy .NET udostêpnianych przez CLR \cite{Cts}.

\item \textsl{CLS (ang. Common Language Specification)}

\tab Wspólna specyfikacja jêzyka CLS jest zestawem podstawowych zasad które spe³niaj¹ jêzyki programowania rodziny .NET \cite{Cls}.

\end{itemize}


Platforma .NET zapewnia wsparcie dla jêzyka C\#, który jest obecnie jednym z najpopularniejszych jêzyków programowania na œwiecie. Wed³ug rankingu firmy TIOBE Software z grudnia 2015 r. znajduje siê on na pi¹tym miejscu, spoœród piêædziesiêciu sklasyfikowanych jêzyków. Pocz¹wszy od 2000 r. jêzyk C\# awansowa³ z dziesi¹tego miejsca na pi¹te \cite{CRanking}. 

C\# jest nowoczesnym, obiektowym jêzykiem programowania, wyprodukowanym przez firmê Microsoft. Zosta³ wydany po raz pierwszy w lipcu 2002 r. G³ównym projektantem jêzyka jest duñski in¿ynier oprogramowania Anders Hejlsberg \cite{chash}. Mo¿e zostaæ wykorzystywany do pisania aplikacji desktopowych, internetowych oraz mobilnych. Programy napisane w C\# kompilowane s¹ do kodu poœredniego zapisanego w jêzyku CIL (ang. Common Intermediate Language) i wykonywane w œrodowisku uruchomieniowym .NET Framework. Jest on uznawany za prosty w nauce jêzyk, poniewa¿ posiada szereg modu³ów oraz udogodnieñ u³atwiaj¹cych pracê programistom, takich jak \cite{cadv}:

\begin{itemize}

\item \textsl{Odœmiecanie pamiêci (ang. Garbage collection)}

\tab Dynamicznie przydzielona pamiêæ jest zwalniana automatycznie.

\item \textsl{Brak koniecznoœci tworzenia plików nag³ówkowych .h w porównaniu do jêzyka C++}

\item \textsl{Mo¿liwoœæ przeci¹¿ania operatorów w porównaniu do jêzyka Java}

\item \textsl{Zmienne inicjalizowane s¹ swoimi domyœlnymi wartoœciami}

\item \textsl{Wprowadzenie dodatkowych elementów sk³adowych klas, takich jak w³aœciwoœci i indeksery}

\end{itemize}
\subsubsection{WPF}

WPF (ang. Windows Presentation Foundation) \cite{WPF} jest technologi¹, któr¹ wprowadzono w .Net 3.0. Wykorzystuje jêzyk XML, a dok³adnie jego odmianê XAML. Do wyœwietlania okien wykorzystywana jest grafika wektorowa, co jest wspomagane przez karty graficzne. Cechuje siê on bardzo du¿¹ elastycznoœci¹ w tworzeniu interfejsu, miedzy innymi tworzenie przycisku z obrazkiem. Technologia ta zosta³a zaprojektowana, tak ¿eby w jak najwiêkszym stopniu odseparowaæ wygl¹d aplikacji od innych warstw programu. W niektórych przypadkach wi¹¿e siê z dodatkowym nak³adem pracy w stosunku do technologii Winforms  np. wyœwietlany obrazek w kontrolerze ListView . Jeœli chodzi o wygl¹d aplikacji dziêki du¿ej elastycznoœci jest mo¿liwe tworzenie programów z interfejsem 3D. Nie tylko ró¿ni siê mo¿liwoœciami tworzenia interfejsów, ale i wewnêtrznymi mechanizmami. WPF wykorzystuje dedykowany mechanizm do prezentacji aplikacji, w stosunku do Winformsów, który wywo³uje tylko elementy WinAPI. Wi¹¿e siê to z brakiem wiêkszych mo¿liwoœci edycji wygl¹du aplikacji. Nastêpn¹ cech¹ istotn¹ z punktu dzia³ania programu jest odœwie¿anie elementów okna. W przypadku Winformsów najechanie na jakikolwiek element z w³aœciwoœci¹ zmiany wygl¹du np. zmiany podœwietlania po najechaniu powoduje odœwie¿enie ca³ego okna programu, co nie ma miejsca w przypadku programów tworzonych w WPF. Bardzo dobre wsparcie dla wzorca architektonicznego MVVM uzyskuje siê poprzez mo¿liwoœæ pod³¹czania (binding) w³aœciwoœci z zewnêtrznych klas. Ten typ podejœcia umo¿liwia szybkie tworzenie elementów programu.

\subsubsection{XAML}

XAML jest to oparty na XML\cite{Xml} deklaratywny jêzyk znaczników, którego zadaniem jest opis interfejsu u¿ytkownika obecnego w zastosowanej przez zespó³ technologii WPF. W technologii tej jêzyk XAML umo¿liwia zaprojektowanie oraz u³o¿enie wszystkich elementów wizualnych takich jak kontrolki, ramki oraz okna, a tak¿e pozwala na rozdzielenie pracy pomiêdzy programistami (back-end) oraz grafikami (front-end), którzy tworz¹ graficzny interfejs u¿ytkownika. Graficy, przez wzgl¹d na zakres obowi¹zków, nie czêsto znaj¹ jêzyk programowania C\#. Problem ten rozwi¹zuje w³aœnie XAML, który umo¿liwia zrozumienie przez nich zasady dzia³ania poszczególnych okien, powi¹zañ miêdzy nimi oraz projektowanie interfejsu w prosty sposób z poziomu drzewiastej struktury lub dedykowanego narzêdzia Expression Blend, które umo¿liwia przeprowadzenie wszystkich powy¿szych operacji z poziomu swojego œrodowiska graficznego.
\subsubsection{T-SQl}

Jest to krótkie okreœlenie Transaction-SQL, które jest rozwiniêciem standardowego SQL. Jêzyk SQL zosta³ stworzony specjalne dla relacyjnych baz danych opracowa³a go na pocz¹tku lat 70 firma IBM \cite{bazy}, jest to standard otwarty. Wspó³czeœnie jest on wykorzystywany przez wiêkszoœæ firm do tworzenia zapytañ bazodanowych. Wiele firm dodaje swoje usprawnienia w zale¿noœci, co odczuje za stosowne by rozszerzyæ mo¿liwoœæ i przyspieszyæ pracê baz danych np. PL/SQL firmy Oracle.  
T-SQL jest jêzykiem transakcyjny, polega na wykonywanie operacji, jeœli operacja zosta³a zaakceptowana to nastêpuje zapis do bazy, mo¿na to porównaæ do przelewów bankowych zabranie z jednego konta i przelaniu na drugie konto, jeœli na pierwszym koncie jest suma potrzebna do przelewu. W przeciwnym wypadku przelew nie nastêpuje tak jak zapis do bazy, jeœli dane bêd¹ nieprawid³owe. Umo¿liwia równie¿ tworzenie zmiennych, pêtli jak równie¿ instrukcji warunkowych.

\subsection{Wykorzystane narzêdzia}
\subsubsection{Visual Studio 2013}

Do napisania projektu zosta³ wykorzystany Visual Studio w wersji 2013 \cite{VS} edycja Professional. Jest to bardzo rozbudowany kompilator ze zintegrowanym debuggerem. Wspiera on bardzo wiele jêzyków programowania miedzy innymi JavaScript, HTML, C\#, VB, XAML, C++.  Standardowym œrodowiskiem dla technologii jakimi s¹ WPF .NET/C\#  jest Visual Studio. Dziêki wbudowanym mechanizmom istnieje równie¿ mo¿liwoœci ich rozszerzania poprzez napisanie dodatków z wykorzystaniem SDK. Mo¿na równie¿ pobraæ ju¿ gotowe rozszerzenia z Visual  studio gallery  \cite{VSG} stworzonych przez innych u¿ytkowników zrzeszonych wœród produktów firmy Microsoft. Wbudowanym mechanizmem jest debugger, który umo¿liwia œledzenie programu krok po kroku. Pozwala to na szybkie znajdowanie b³êdów w kodzie i ich naprawê. Nastêpnym przydatnym mechanizmem jest system IntelliSense, który odpowiedzialny jest  za podpowiadanie elementów sk³adowych klas. Technologia to wspomagana jest równie¿ przez odpowiednie komentowanie kodu tak by te komentarze te¿ siê wyœwietla³y w podpowiedzi. Dziêki temu mechanizmowi istnieje mo¿liwoœæ szybszego odnajdywania poszczególnych elementów klasy, który s¹ w danym momencie wymagane. Wykorzystuj¹c odpowiednie udogodnienia istnieje mo¿liwoœæ szybszego pisania kodu, co przek³ada siê na iloœæ kodu do napisania przez programistê. Kolejnym istotnym elementem z punktu widzenia projektu jest mo¿liwoœæ projektowania okien w dwóch technologiach WPF i Winforms. U³atwia to pracê nad interfejsem u¿ytkownika, poniewa¿ wyeliminowana jest koniecznoœæ ci¹g³ego uruchamiania pisanego programu. Zawiera równie¿ wiele predefiniowanych elementów dla tworzonego wygl¹du miedzy innymi pola tekstowe, przyciski. Wykorzystuj¹c technikê drag-and-drop mo¿na w ³awy sposób ustawiaæ elementy w wybranym przez siebie miejscu.


\subsubsection{SQL Server Management Studio}

W trakcie prac nad projektem wykorzystano darmowe narzêdzie do zarz¹dzania baz¹ danych SQL Server Management Studio 2012 Express \cite{SQL Server Management Studio Express} wynika to z istniej¹cej infrastruktury opartej na rozwi¹zaniach Microsoftu, co u³atwi³o nam pracê i proces projektowania ca³ej bazy danych. Dziêki przejrzystemu interfejsowi u¿ytkownika, mo¿na w bardzo ³atwy sposób tworzyæ nawet bardzo skomplikowane struktury, bez koniecznoœci znajomoœci jêzyka tworz¹cego bazê danych.  Program ten u³atwi³ tworzenie wymaganej przez sieæ hotelow¹ bazy danych. Istnieje równie¿ mo¿liwoœæ generowania skryptów, których zadaniem jest odtworzenie ca³ej struktury bazy danych. W programie jest równie¿ mo¿liwoœæ tworzenia diagramów: wszystkich jak równie¿ wybranych tabel. Te mo¿liwoœci przedstawia rysunek  \ref{rys:interfejsSQL} Umo¿liwia to diagnozowanie problemu braku po³¹czeñ niektórych tabel z reszt¹ struktury. 

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{diagrambazy.jpg}
    \caption{Interfejs SQL Server Management Studio Express, ród³o: Opracowanie w³asne.}
     \label{rys:interfejsSQL}
\end{figure}
Wykorzystuj¹c wbudowane mechanizmy mo¿liwe jest ³atwe wpisywanie pocz¹tkowych danych takich jak: u¿ytkownicy systemu, ceny produktów, ich edycja na poziomie bazy. Umo¿liwia to sprawdzenie, czy baza dzia³a zgodnie oczekiwaniami. W ten sposób mo¿na œledziæ dzia³anie naszego programu w trakcie pracy. Sprawdziæ mo¿na czy wszystkie elementy prawid³owo dzia³aj¹ i czy w poprawny sposób jest zapisywana dana pozycja.   
\subsubsection{Trello}

Podczas pracy zespo³owej napotyka siê liczne problemy zwi¹zane z organizacj¹ pracy, jej synchronizacj¹ oraz podzia³em obowi¹zków. Stopieñ zaawansowania przedstawionych problemów dodatkowo wzrasta, w sytuacji, gdy wspó³praca zespo³u przebiega zdalnie. W takich okolicznoœciach warto pos³u¿yæ siê dedykowanymi narzêdziami, które umo¿liwiaj¹ prost¹, szybk¹ i skuteczn¹ komunikacjê wspieraj¹c¹ pracê wielu osób nad jednym projektem. 
Trello jest to darmowa aplikacja, której przeznaczeniem jest wspieranie organizacji pracy grupowej opieraj¹c siê na metodyce Kanban \cite{Kanban}, która zaadoptowana zosta³a na potrzeby in¿ynierii oprogramowania. Potencjalny wzrost wydajnoœci pracy przy u¿yciu Trello ma nast¹piæ dziêki scentralizowanemu systemowi zarz¹dzania projektem opieraj¹cemu siê na wirtualnych tablicach oraz ulokowanych na nich list zadañ, które mo¿na dostrzec na rysunku \ref{rys:InterfejsTrello}
\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{trello.jpg}
    \caption{Interfejs aplikacji webowej Trello, ród³o: Opracowanie w³asne.}
    \label{rys:InterfejsTrello}
\end{figure}

Listy te umo¿liwiaj¹ konstruowanie zadañ w postaci tak zwanych kafelek, które w intuicyjny sposób mo¿na przenosiæ pomiêdzy listami za pomoc¹ techniki drag-and-drop. Ka¿da kafelka reprezentuj¹ca zadanie w Trello posiada szereg dodatkowych funkcjonalnoœci, które mo¿na dostrzec na za³¹czonym rysunku \ref{rys:KafelkaTrello}. W czasie pracy nad projektem wykorzystano opcjê przypisania konkretnej osoby lub grupy osób do zadania, co jednoznacznie determinowa³o odpowiedzialnoœæ jego wykonania oraz funkcjê utworzenia listy czynnoœci, które nale¿y wykonaæ w celu realizacji zadania. Dodatkowym wa¿nym aspektem jest data, która po wspólnych ustaleniach przypisywana jest do konkretnego zadania i stanowi ostateczny termin wprowadzenia danej funkcjonalnoœci.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.75\textwidth]{trello2.jpg}
    \caption{Szczegó³y zadania na pojedynczej kafelce., ród³o: Opracowanie
     w³asne.}
    \label{rys:KafelkaTrello}
\end{figure}

Ciekaw¹ funkcjonalnoœci¹ godn¹ przedstawienia s¹ tak¿e powiadomienia zmian, które w sposób automatyczny przekazywane s¹ na skrzynkê elektroniczn¹ lub jako powiadomienia push na urz¹dzenia przenoœne. 
Dziêki temu, i¿ narzêdzie Trello dostêpne jest w postaci webowej, a tak¿e jako aplikacja mobilna na Androida, iOS oraz Windows 8 \cite{PlatformyTrello}, dostêp do niej jest w znaczny sposób u³atwiony. Umo¿liwia to otrzymanie niemal natychmiastowej informacji o naniesionych zmianach w projekcie lub zbli¿aj¹cym siê terminie ukoñczenia zadania, do którego jesteœmy przypisani.

Wszystkie przedstawione funkcjonalnoœci narzêdzia Trello umo¿liwi³y zespo³owi uproszczenie i przyspieszenie procesu organizacji pracy nad projektem co w konsekwencji doprowadzi³o do oszczêdnoœci czasowych, które przeznaczone zosta³y na elementy implementacyjne budowanego systemu.

\newpage

\subsubsection{Git/SourceTree/GitHub}

Oprogramowanie wytwarzane jest przez kilkuosobowe zespo³y programistyczne, a pliki Ÿród³owe projektów przechowywane s¹ na serwerach. Jednym z aspektów pracy zespo³owej jest ³¹czenie równolegle wytwarzanego kodu Ÿród³owego przez poszczególnych programistów. W tym celu zespo³y u¿ywaj¹ systemów kontroli wersji (ang. version control system) które umo¿liwiaj¹ integracjê zmian wykonanych na plikach. W prostym jêzyku oznacza to, ¿e programista pobiera aktualn¹ wersjê plików i odsy³a je do serwera wraz z nowym kodem Ÿród³owym \cite{version}. Istniej¹ trzy rodzaje systemów kontroli wersji \cite{versionrodzaje}:

\begin{itemize}

\item \textsl{Lokalne (np. RCS)}

\tab Umo¿liwiaj¹ kontrolê plików tylko na lokalnych komputerach.

\item \textsl{Scentralizowane (np. SVN)}

\tab Oparte o architekturê typu klient-serwer. Poprzednie wersje plików przechowywane s¹ tylko na serwerze.

\item \textsl{Rozproszone (np. Git)}

\tab Opartê o architekturê P2P. Poprzednie wersje plików przechowywane s¹ na serwerze i w lokalnych repozytoriach, co zabezpiecza przed utrat¹ danych.

\end{itemize}

Popularnym systemem kontroli wersji jest Git, wydany na darmowej licencji. Zosta³ stworzony przez Linusa Torvalds'a, po raz piewszy wydany w 2005 roku \cite{git0}. Posiada w³asn¹ stronê internetow¹, zawieraj¹c¹ dokumentacje oraz pliki binarne programu \cite{git}. Jest wieloplatformowy, posiada dystrybucje dedykowane zarówno dla systemów rodziny Linux, jak i Windows czy OS X. Posiada nastêpuj¹ce zalety, które zdecydowa³y o u¿yciu systemu do synchronizacji zmian w niniejszym projekcie \cite{gitadv}:

\begin{itemize}
\item \textsl{Bezpieczeñstwo danych}

\tab W razie awarii serwera, mo¿na odtworzyæ poprzednie wersje plików na podstawie lokalnej kopii.

\item \textsl{Równoleg³a praca}

\tab Git umo¿liwia niezale¿ny rozwój oprogramowania, poprzez tworzenie tzw. ga³êzi (ang. branch). Zazwyczaj projekty dzielone s¹ na ga³êzie poszczególnych programistów i ga³¹Ÿ g³ówna tzw. master branch. Ga³êzie mog¹ byæ ³¹czone (ang. merge) w dowolnym momencie.

\item \textsl{Oszczêdnoœæ przestrzeni dyskowej}

\tab W porównaniu do SVN, gdzie ka¿da ga³¹Ÿ jest kopi¹ ca³ego projektu Git posiada mechanizmy synchronizuj¹ce ró¿nice pomiêdzy poszczególnymi wersjami plików. 

\end{itemize}

Historia zmian dokonanych w plikach Ÿród³owych zapisywana jest za pomoc¹ polecenia commit, które nadaje identyfikator aktualnej wersji projektu, opis zmian (opcjonalnie) oraz spis zmodyfikowanych plików. Pliki na serwer wysy³ane s¹ za pomoc¹ komendy push. Pobieranie plików zamieszczanych na serwerze przez pozosta³ych cz³onków zespo³u umo¿liwia komenda fetch, natomiast synchronizacjê zmian z lokaln¹ kopi¹ umo¿liwia komenda pull. 
Git jest programem dzia³aj¹cym w linii poleceñ. Istnieje równie¿ graficzna nak³adka na Git'a, któr¹ jest Atlassian SourceTree. Jest on darmowym programem, jednak po up³ywie trzydziestu dni od instalacji, u¿ytkownik zobowi¹zany jest do rejestracji konta w celu dalszego korzystania z aplikacji \cite{treelic}. Posiada dystrybucje dla systemu Windows oraz OS X. Oprócz standardowych funkcjonalnoœci Git'a umo¿liwia podgl¹d zmian w plikach dla poszczególnych commit'ów \cite{tree}. Podczas pracy nad projektem programistycznym, prawdopodobn¹ sytuacj¹ jest dokonanie zmian na tym samym pliku przez dwóch programistów. Jeœli zmiany wzajemnie siê wykluczaj¹, problem mo¿na rozwi¹zaæ za pomoc¹ zewnêtrznego narzêdzia do rozwi¹zywania konfliktów SVN. Umo¿liwia on u¿ytkownikowi porównanie ró¿nic w poszczególnych wersjach pliku. Programista wybiera bloki kodu Ÿród³owego które maj¹ zostaæ zapisane w pliku, zatwierdza zmiany a konflikt zostaje oznaczony jako rozwi¹zany. Rysunek \ref{rys:SourceTree} przedstawia okno g³ówne SourceTree.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{tree.jpg}
    \caption{Atlassian SourceTree - okno g³ówne, ród³o: Opracowanie w³asne.}
    \label{rys:SourceTree}
\end{figure}


GitHub.com jest darmowym serwisem internetowym który pozwala na przechowywanie projektów programistycznych, wspiera system kontroli wersji Git. Pierwsza wersja zosta³a wydana, w kwietniu 2008 roku \cite{github}. GitHub umo¿liwia miêdzy innymi tworzenie i zarz¹dzanie repozytoriami (np. nadawanie uprawnieñ dostêpu wspó³pracownikom), podgl¹d plików danego projektu. Rysunek \ref{rys:RepozytoriumWWW} przedstawia repozytorium niniejszego projektu. Ciekaw¹ funkcjonalnoœci¹ serwisu przedstawion¹ na rysunku \ref{rys:GitHub}, jest opracowywanie statystyk u¿ytkowników, i prezentowanie ich wk³adu w konkretny projekt w formie wykresów. 

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{repowww.jpg}
    \caption{Interfejs repozytorium w witrynie GiHub.com, ród³o: Opracowanie w³asne.}
    \label{rys:RepozytoriumWWW}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.85\textwidth]{github.jpg}
    \caption{Statystyka wk³adu pracy z dnia 13 grudnia 2015 r., ród³o: Opracowanie w³asne.}
    \label{rys:GitHub}
\end{figure}

\clearpage
\subsubsection{ReSharper}

Wydajnoœæ pracy w projektach developerskich jest kluczow¹ kwesti¹, która bezpoœrednio przek³ada siê na korzyœci finansowe i zaoszczêdzony czas. Istniej¹ narzêdzia, których przeznaczeniem jest zwiêkszenie efektywnoœci pracy programisty poprzez zautomatyzowanie czêsto powtarzaj¹cych siê czynnoœci oraz nadzorowanie pisanego kodu wed³ug ustalonych wczeœniej zasad.

ReSharper jest to narzêdzie zaprojektowane z myœl¹ o programistach .NET \cite{.NETOpis} pracuj¹cych w Microsoft Visual Studio, które w znacznym stopniu rozszerza dostêpn¹ funkcjonalnoœæ wy¿ej wymienionego œrodowiska, u³atwiaj¹c tym samym pisanie oraz refaktoryzacjê kodu.

Funkcje dostêpne z poziomu ReSharpera mo¿na podzieliæ na kilkanaœcie modu³ów, z których jednym z najwa¿niejszych jest modu³ zajmuj¹cy siê inspekcj¹ kodu. Podczas pracy programisty z uruchomionym w tle ReSharperem, w czasie rzeczywistym sprawdzane jest ponad 1700 regu³ dotycz¹cych prawid³owoœci kodu i w sytuacji znalezienia nieœcis³oœci, znaleziony wyj¹tek natychmiast wyœwietlany jest na poziomie graficznego interfejsu Visual Studio z dok³adnym jego opisem i miejscem wyst¹pienia. Wyj¹tki te dotycz¹ miêdzy innymi mo¿liwoœci zast¹pienia fragmentu kodu jego wydajniejsz¹ wersj¹, ostrze¿eniem programisty przed kodem, który potencjalnie mo¿e doprowadziæ do nieprawid³owego dzia³ania ca³ego oprogramowania lub informacj¹ o fragmencie, który jest kodem martwym \cite{MartwyKod}. Przyk³ad kodu, który spowodowaæ mo¿e nieprawid³owe dzia³anie aplikacji oraz przyk³adowe jego rozwi¹zania dostêpne s¹ do wgl¹du na rysunku \ref{rys:ResharperNullReference}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{ResharperNullReference.jpg}
    \caption{Informacja Resharpera dotycz¹ca potencjalnej mo¿liwoœci wyst¹pienia wyj¹tku NullReferenceException, ród³o: Opracowanie w³asne.}
    \label{rys:ResharperNullReference}
\end{figure}

Kolejnym bardzo istotnym modu³em jest modu³ generowania kodu. Podczas programowania wiele czynnoœci takich jak pisanie nowych klas, metod, implementacja interfejsów czy zmiana nazw wielokrotnie siê powtarza. Dziêki odpowiednim skrótom klawiszowym wszystkie te elementy ReSharper wykona za programistê. Przeniesie on wybran¹ klasê do oddzielnego pliku, utworzy na podstawie nazwy i jej typu szablon brakuj¹cej metody, wygeneruje wymagane przy dziedziczeniu interfejsu wszystkie jego elementy oraz automatycznie zamieni wybran¹ nazwê na now¹, w ka¿dym miejscu jej wystêpowania. Szczególnie ostatnia opcja w pracy przy rozbudowanym systemie jest wyj¹tkowo przydatna i znacznie skraca czas wykonywanej czynnoœci.

Przedstawione funkcjonalnoœci ReSharpera wraz z wieloma innymi dostêpnymi do zapoznania siê pod \cite{ReSharperFunkcje} elementami, umo¿liwi³y skrócenie etapu implementacji wymaganych w projekcie modu³ów poprzez zautomatyzowanie powtarzaj¹cych siê czynnoœci i zniwelowanie pojawiaj¹cych siê zagro¿eñ ju¿ we wczesnej fazie pisania kodu. Korzyœci¹ p³yn¹c¹ z tego rozwi¹zania by³a oszczêdnoœæ czasowa, która umo¿liwi³a zwrócenie wiêkszej uwagi na aspekt przetestowania zastosowanych rozwi¹zañ.

\subsubsection{Jenkins}

Jenkins Continuous Integration Server jest darmowym, wieloplatformowym narzêdziem s³u¿acym do ci¹g³ej integracji projektów programistycznych. Zosta³ napisany w jêzyku Java, wywodzi siê od narzêdzia Hudson. Zosta³ wydany po raz pierwszy w 2011 r. \cite{jenkins}. Posiada szereg wtyczek zapewniaj¹cych funkcjonalnoœci takie jak statyczna analiza kodu, automatyczne tworzenie dokumentacji kodu Ÿród³owego, powiadomienia e-mail, pobieranie plików z repozytoriów. Pozwala na budowanie oraz testowanie projektów w popularnych jêzykach programowania, m. in. w jezyku C\# czy Java. Jenkins jest aplikacj¹ internetow¹, domyœlnie dzia³aj¹c¹ na porcie 8080. Zadania do wykonania definiowane s¹ w postaci planów (ang. job) które mog¹ byæ uruchamiane cyklicznie, zgodnie z okreœlonym harmonogramem lub manualnie. Plany wykonywane s¹ w tzw. obszarach roboczych (ang. wokrspace) które s¹ katalogami na dysku \cite{jenkins2}. 

\subsection{Biblioteki zewnêtrzne}
\subsubsection{Extended WPF Toolkit}

Wa¿nym aspektem ka¿dego rodzaju oprogramowania u¿ytkowego jest stopieñ trudnoœci jego obs³ugi. Interfejs graficzny aplikacji powinien byæ budowany w sposób przejrzysty i intuicyjny dla u¿ytkownika w celu bezproblemowego korzystania z wszystkich jej funkcjonalnoœci. Ka¿dy element programu, który przysparza u¿ytkownikowi problem w obs³udze jest potencjalnym fragmentem, który mo¿e doprowadziæ do nieprawid³owego dzia³ania oprogramowania. Dla przyk³adu pole, do którego u¿ytkownik zobowi¹zany jest wprowadziæ datê mo¿e przysporzyæ sporo problemów w sytuacji, gdy jest ono zwyk³ym polem tekstowym. W takim przypadku nie wiadomo jaki jest po¿¹dany format daty, co implikuje koniecznoœæ dok³adnej walidacji wpisanych przez u¿ytkownika ci¹gów znaków oraz informacji zwrotnej w sytuacji b³êdnej ich formy.

Domyœlnie technologia WPF podobnie jak WinForms posiada wbudowany pakiet kontrolek graficznych wraz z ich licznymi w³asnoœciami i zdarzeniami. W³asnoœci te umo¿liwiaj¹ okreœlenie dok³adnej formy u¿ytej kontrolki dotycz¹cej jej koloru, wielkoœci, po³o¿enia, wyrównania, nazwy oraz widocznoœci. Zdarzenia kontrolki z kolei odpowiadaj¹ za jej reakcje w czasie interakcji z u¿ytkownikiem oprogramowania w którym zosta³a zastosowana. Zdarzenia te dotycz¹ dla przyk³adu klikniêcia w kontrolkê, przesuniêcia kursora myszki nad ni¹ oraz jej przesuniêcia.

Liczba domyœlnych kontrolek dla zaimplementowania niektórych funkcjonalnoœci nie jest jednak wystarczaj¹ca. Odwo³uj¹c siê do przytoczonego przyk³adu wpisania daty przez u¿ytkownika, WPF wymaga od programisty du¿ego wk³adu pracy do prawid³owego wykonania tej funkcjonalnoœci. Z pomoc¹ przychodz¹ jednak dedykowane biblioteki rozszerzaj¹ce, z których jedn¹ jest Extended WPF Toolkit.

Extended WPF Toolkit jest to darmowa biblioteka przeznaczona dla technologii WPF, która rozpowszechniana jest na zasadach Microsoft Public Licence \cite{MicrosoftPublicLicence}. Biblioteka ta w znacznym zakresie rozszerza liczbê domyœlnych kontrolek umo¿liwiaj¹c szybk¹ i prost¹ implementacjê licznych funkcjonalnoœci, których nie umo¿liwia³y kontrolki domyœlne. 

Jednym z elementów, dla którego przedstawiona biblioteka znalaz³a zastosowanie w projekcie jest wpisywanie przez u¿ytkownika wartoœci liczbowej do ustalonego pola. Kontrolka IntegerUpDown umo¿liwia programiœcie zapisanie w jej w³asnoœciach zakresu przyjmowanych liczb, które niweluj¹ koniecznoœæ implementacji dodatkowej walidacji. Dodaj¹c do tego domyœlne funkcje powy¿szej kontrolki odnosz¹ce siê do wewnêtrznego sprawdzania typu wpisanych przez u¿ytkownika znaków, podkreœlania i nieprzyjmowania b³êdnych danych oraz dwóch graficznych przycisków, które umo¿liwiaj¹ po ich naciœniêciu zmiany wpisanej wartoœci, kontrolka ta doskonale nadaje siê do przedstawionej funkcjonalnoœci odci¹¿aj¹c przy tym w znaczny sposób programistê.

Kolejnym miejscem zastosowania biblioteki Extended WPF Toolkit w projekcie jest ustalanie z poziomu programu daty oraz godziny. Do tych celów pos³u¿ono siê dwiema dodatkowymi kontrolkami DatePicker oraz TimePicker.
Kontrolka DatePicker, której wygl¹d przedstawiony zosta³ na rysunku \ref{rys:DatePicker}, umo¿liwia u¿ytkownikowi wybór daty w ustandaryzowanym formacie. Po operacji naciœniêcia kursorem myszki w przedstawian¹ kontrolkê wyœwietlany jest przejrzysty kalendarz, w którym proces wyboru daty polega na wybraniu przez u¿ytkownika odpowiedniego roku, miesi¹ca, a nastêpnie klikniêcia w dzieñ odpowiadaj¹cy jego potrzebom. Istnieje tak¿e mo¿liwoœæ wpisania rêcznie daty, z t¹ ró¿nic¹, i¿ musi byæ ona podana w formacie RRRR-MM-DD. Zapis daty w innych formatach zostanie automatycznie wykryty przez mechanizmy wewnêtrzne kontrolki jako niepoprawny, a wpisana wartoœæ usuniêta.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.25\textwidth]{ExtendedWpfDataPicker.jpg}
    \caption{Kontrolka DatePicker, ród³o: Opracowanie w³asne.}
	\label{rys:DatePicker}
\end{figure}

Walidacja godziny, analogicznie jak daty, tak¿e mo¿e doprowadziæ do wielu problemów na tle jednolitego formatu danych. Zastosowana kontrolka TimePicker widoczna na rysunku \ref{rys:TimePicker} niweluje ten problem poprzez wprowadzenie mechanizmów czuwaj¹cych nad prawid³owym formatem wpisanej godziny i w przypadku b³êdnego jej wprowadzenia, podobnie jak DatePicker, usuwa j¹. U¿ytkownik samodzielnie mo¿e wpisaæ godzinê w formacie GG:MM lub za pomoc¹ przycisków odpowiednio ustaliæ jej wartoœci.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.25\textwidth]{ExtendedWpfTimePicker.jpg}
    \caption{Kontrolka TimePicker, ród³o: Opracowanie w³asne.}
    \label{rys:TimePicker}
\end{figure}

\subsubsection{PDFsharp \& MigraDoc Foundation}

PDF (ang. Portable Document Format) czyli tzw. przenoœny format dokumentów, zosta³ zaprojektowany i wdro¿ony przez firmê Adobe Systems w 1992 r. Dokumenty przechowywane w tym formacie mog¹ zawieraæ proste dane tekstowe, jak równie¿ dŸwiêki, grafiki czy tabele. Jedn¹ z zalet formatu jest jego uniwersalnoœæ, wygl¹d pliku jest spójny niezale¿nie od systemu operacyjnego u¿ytkownika \cite{DefinicjaPdf}. Darmowe narzêdzia, takie jak Adobe Acrobat Reader, Foxit Reader umo¿liwiaj¹ podgl¹d plików PDF. Wiêkszoœæ pakietów biurowych takich jak, Microsoft Office czy Apache OpenOffice umo¿liwia zapis plików do formatu PDF. Popularnoœæ PDF stale wzrasta \cite{PopularnoscPdf}. Wszelkie rachunki, faktury, prace naukowe s¹ archiwizowane w postaci plików PDF. 

Jednym z celów projektu, jest przedstawienie szczegó³ów transakcji pomiêdzy klientem, a sprzedawc¹ w formie lekkiego i przejrzystego dokumentu. Format PDF spe³nia za³o¿one wymagania. Do implementacji modu³u tworz¹cego dokument wykorzystano bibliotekê PDFSharp \& Migradoc Foundation dla jêzyka C\#.

PDFSharp \& Migradoc Foundation jest darmow¹ bibliotek¹ umo¿liwiaj¹c¹ tworzenie dokumentów PDF w jêzykach programowania z rodziny .NET. Oferowane funkcjonalnoœci to m. in. tworzenie paragrafów, tabel, formatowanie tekstu, za³¹czanie oraz skalowanie grafiki. Projekt posiada dedykowan¹ stronê internetow¹ zawieraj¹c¹ dokumentacjê i przyk³adowe programy wraz z kodami Ÿród³owymi \cite{PdfSharp}. Instalacja w Microsoft Visual Studio jest mo¿liwa za pomoc¹ mened¿era pakietów Nuget. 

\section{Implementacja}
\subsection{Architektura aplikacji}
\subsubsection{Wzorce architektoniczne oprogramowania}

W in¿ynierii oprogramowania analogicznie jak w innych dziedzinach, w których przeprowadzana jest operacja budowania zadanego przedmiotu, nale¿y starannie zaplanowaæ jego proces. W tym calu nale¿y kierowaæ siê przyjêtymi fazami produkcji oprogramowania \cite{FazyProdukcjiOprogramowania}. Fazy te mówi¹ o tym, i¿ nale¿y dok³adnie okreœliæ wymagania, które powinno budowane oprogramowanie spe³niaæ, a nastêpnie ustaliæ jego ogóln¹ architekturê. Punkt ten jest niebywale wa¿ny z racji na problematycznoœæ zmiany architektury zbudowanego ju¿ systemu. W celu zobrazowania tego zagadnienia mo¿na przywo³aæ operacjê budowy budynku. Wszelkie zmiany dotycz¹ce jego konstrukcji s¹ ciê¿kie do zrealizowania w sytuacji, w której jest on ju¿ fizycznie gotowy. Kolejne fazy polegaj¹ na realizacji opisanej wczeœniej architektury poprzez implementacjê wszystkich komponentów oprogramowania wraz z ich wzajemnymi po³¹czeniami, przetestowaniem ca³ego systemu oraz jego finalnemu uruchomieniu wraz z usuwaniem wykrytych podczas jego dzia³ania b³êdów.

Odnosz¹c siê do planowania architektury systemu bardzo pomocne okazuj¹ siê dostêpne wzorce architektoniczne. Wzorce te s¹ to sprawdzone oraz zaakceptowane sposoby rozwi¹zania danego problemu z dziedziny architektury oprogramowania, okreœlaj¹ce ogóln¹ strukturê systemu informatycznego, zasady komunikacji pomiêdzy komponentami oraz elementy wchodz¹ce w jego sk³ad wraz z opisem ich funkcji. Wybór odpowiedniego wzorca w du¿ej mierze zale¿ny jest od wykorzystanej w projekcie technologii. W przypadku WPF powszechnie uznanym rozwi¹zaniem jest MVVM (Model View ViewModel) \cite{MvvmOpis}, który jest zmodyfikowan¹ wersj¹ wzorca MVC, zawieraj¹c¹ specjalizacjê modelu prezentacji.

\subsubsection{Zastosowany wzorzec architektoniczny – MVVM}

MVVM jest to wzorzec, który dziêki funkcjonalnoœci odseparowania warstwy prezentacji od warstwy logiki biznesowej, umo¿liwia napisanie ³atwo testowalnej oraz prostej w rozbudowanie aplikacji, której fragment kodu mo¿e zostaæ ponownie u¿yty w innych projektach. Opisywany wzorzec cieszy siê du¿¹ popularnoœci¹ w gronie developerów WPF z powodu mo¿liwoœci wykorzystania najwiêkszych atutów tej technologii, takich jak komendy (command), wi¹zania (binding) oraz zachowania (behavior). Kod aplikacji o architekturze Model-View-ViewModel podzielony jest, zgodnie z jego nazw¹ na trzy oddzielne warstwy Model, View oraz ViewModel, z których ka¿da przechowuje dedykowane dla siebie dane i spe³nia okreœlone funkcje. Z graficznym podzia³em wraz z kierunkiem przep³ywu danych mo¿na zapoznaæ siê pod rysunkiem \ref{rys:MvvmDiagram}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{MvvmDiagram.jpg}
    \caption{Przep³yw danych w modelu MVVM, ród³o: www.tomaszmalesza.pl}
    \label{rys:MvvmDiagram}
\end{figure}
%www.tomaszmalesza.pl/wp-content/uploads/2012/08/MVVM\_Relation1.jpg

Model to warstwa, która odpowiedzialna jest w omawianym wzorcu za logikê biznesow¹ aplikacji \cite{LogikaBiznesowa}. W przypadku przedstawianego projektu in¿ynierskiego warstwa ta reprezentowana jest przez przez klasy, które utworzone zosta³y za pomoc¹ biblioteki Entity Framework, s³u¿¹cej do odwzorowania relacyjnej bazy danych na obiekty dostêpne z poziomu kodu. Wszelkie klasy zawieraj¹ce dane, które maja przekazane byæ z poziomu modelu do warstwy widoku, z którego u¿ytkownik mo¿e owe informacje odczytaæ zobowi¹zane s¹ do implementacji interfejsu INotifyPropertyChanged lub INotifyCollectionChanged, który wspó³pracuje z bindingiem \cite{DataBinding} wykorzystywanym w WPF.

ViewModel zajmuje siê reprezentacj¹ danych, które wysy³ane s¹ do widoku, nie maj¹c przy tym ¿adnej referencji do niego. Widok odnosi siê do elementów ViewModelu za poœrednictwem komend oraz wspomnianych operacji bindowania, co zapewnia pe³n¹ separacjê warstwy ViewModelu i umo¿liwia przetestowanie jej odrêbnie od modelu i czêœci prezentuj¹cej.

Wastwa widoku (View) odpowiedzialna jest za wyœwietlanie danych i pe³ni rolê wy³¹cznie prezentacyjn¹. Jej komunikacja z warstw¹ modelu przebiega za poœrednictwem warstwy poœrednicz¹cej ViewModel, do której jest przy³¹czona za pomoc¹ w³aœciwoœci DataContext. W³aœciwoœæ ta wstrzykuje zale¿noœci pomiêdzy View oraz ViewModel, który j¹ kontroluje. 

\subsubsection{Model aplikacji}

Pytanie do promotora:  Opisywaæ podzia³ klas, strukturê folderów aplikacji ? Jest to bardzo techniczna kwestia, nie wiem, czy potrzebna

TODO: after refactor.
- opis warstw (model == baza danych)
- podzial view/viewmodeli
- ilustracja podzialu foldery+klasy

\subsection{Architektura bazy danych}
\subsubsection{Definicja bazy danych}
Bazy danych mo¿na porównaæ do archiwum firmy gdzie s¹ przechowywane wszelakie projekty i dane osobowe. Tabel¹ w kontekœcie tego przyk³adu jest pojedynczy segregator zawieraj¹cy dane o identycznej tematyce. Tabela sk³ada siê z wierszy dalej zwanych rekordami i kolumn. Rekord tworzy spójn¹ ca³oœæ tak jak dane jednej osoby, a kolumny to s¹ poszczególne dane typu imiê nazwisko pesel itp.. Tak jak pesel jest unikatowy dla osoby w firmie tak klucz g³ówny w tabeli te¿ musi byæ unikatowy. Po³¹czenie dwóch segregatorów poprzez na przyk³ad pesel danej osoby to w drugim segregatorze nazywa siê kluczem obcym, a samo po³¹czenie relacj¹. Rozró¿niamy kilka relacji:
\begin{enumerate}
  \item Jeden do, wielu kiedy jedna koszulka w segregatorze ³¹czy siê z wieloma koszulkami w drugim.
  \item Jeden do jednego wystêpuje wtedy, kiedy jedna teczka ³¹czy siê tylko z teczk¹ inn¹ w pojedynczy sposób.
  \item Wiele do wielu wystêpuje wtedy, kiedy jedna koszulka z jednego segregatora odpowiada wielu w drugim i na odwrót.
\end{enumerate}

W projekcie zosta³a wykorzystana baza relacyjna, która dzia³a na powy¿szym przyk³adzie. Wa¿nym z punktu widzenia projektowania aplikacji bazodanowej jest odpowiednie zaprojektowanie struktury tabel i po³¹czeñ miedzy nim. Nie mo¿na lekcewa¿yæ tego procesu. Gdy siê Ÿle zaprojektuje bazê mog¹ wynikn¹æ w póŸniejszym czasie problemy z jej dalszym rozwojem. Istnieje jeszcze gorszy scenariusz, gdy w trakcie dalszych prac baza danych nie bêdzie spe³nia³a swojego zadania. Efektem Ÿle zaprojektowanej bazy danych mo¿e byæ d³ugoœæ wykonywanych zapytaæ jak i bardzo du¿a z³o¿onoœæ. Wi¹¿e siê to z koniecznoœci¹ przeprojektowania od pocz¹tku ca³ej bazy lub starania siê w programie ukryæ te niedomagania.
\subsubsection{MS-SQL – Zastosowany system zarz¹dzania baz¹ danych}

Z racji wykorzystania w projekcie baz danych istnia³a koniecznoœæ uruchomienia serwera bazodanowego. W sieci hotelowej wykorzystane s¹ technologie Microsoftu. Produktem tej firmy zwi¹zanym z powy¿sz¹ tematyk¹ jest  serwer z rodziny  MS-SQL. Serwer ten umo¿liwia tworzenie baz danych dwóch typów relacyjny jak i nierelacyjnych. Tworzenie baz danych mo¿e siê odbywaæ w dwojaki sposób:
\begin{enumerate}
	\item	SQL Server Management Studio, który jest nak³adk¹ graficzn¹
	\item	T-SQL. 
\end{enumerate}
Dziêki wbudowanym typom danych zabezpiecza to przed wpisaniem nieprawid³owej wartoœci w danym miejscu 

\subsubsection{Budowa bazy danych u¿ytej w projekcie}

Bazê, która zosta³a wykorzystana w projekcie mo¿na podzieliæ na dwie g³ówne czêœci: czêœci zawieraj¹c¹ domyœlne wartoœæ na przyk³ad cennik gastronomiczny, wyposa¿enia sali w dalszej czêœci zwane s³ownikami i czêœæ powi¹zana z tworzon¹ propozycj¹ cenow¹. Tabele s³ownikowe przez wzgl¹d na funkcje któr¹ pe³nia nie s¹ powi¹zane z innymi tabelami Taki podzia³ tabel na dwa osobne zbiory zosta³ spowodowany bezpieczeñstwem. Jeœli istnia³aby relacja ³¹cz¹ca te dwie tabele to zmiana wartoœæ w tabeli s³ownikowej powodowa³aby zmianê cen produktów w starszych propozycja. Efektem unikniêcia tego typu problemów jest rozdzielenie na dwie odseparowane czêœci.  Gdyby tak nie by³o wtedy mo¿liwoœæ odtworzenia starej propozycji cenowej by³aby niemo¿liwa, co jest efektem niepo¿¹danym z punktu widzenia dzia³ania aplikacji.  

Drugi cz³on bazy danych stanowi¹ tabele zwi¹zane z tworzon¹ propozycj¹ cenow¹. S¹ one podzielone w logiczny sposób uwzglêdniaj¹c podzia³ przyk³adowej propozycji cenowej przedstawione przez sieæ hotelow¹ na przyk³ad: produkty gastronomiczne, wyposa¿enie sali, szczegó³y rezerwacji.  Podzia³ taki uwzglêdnia mo¿liwoœæ dalszego rozwoju aplikacji.
	

\subsection{Komunikacja bazy danych z projektem programistycznym}
\subsubsection{Mapowanie obiektowo-relacyjne}

Pojêcie mapowania obiektowo-relacyjnego (ORM) odnosi siê do  programistycznego terminu dotycz¹cego wspó³pracy z baz¹ danych, wykorzystuj¹c idee programowania obiektowego. Konkretnie rzecz ujmuj¹c chodzi o zamianê danych, przechowywanych w postaci tabelarycznej w relacyjnej bazie danych na postaæ obiektow¹ dostêpn¹ z poziomu u¿ywanego jêzyka programowania lub w drug¹ stronê.

Przedstawiona translacja danych okaza³a siê bardzo praktyczna przez wzgl¹d na zniwelowanie koniecznoœci zag³êbiania siê w struktury bazy danych przez programistê, a tak¿e w przypadku u¿ycia dodatkowych frameworków, brak wymogu dotycz¹cego jego znajomoœci zapytañ jêzyka SQL przez fakt pracy wy³¹cznie na obiektach, które odwzorowuj¹ strukturê tabel.

Aplikacje komputerowe, których funkcjonalnoœci zorientowane s¹ na wielu u¿ytkowników lub wymuszaj¹ koniecznoœæ ci¹g³ego przechowywania i przetwarzania du¿ych iloœci danych bardzo czêsto korzystaj¹ z systemów bazodanowych. Systemy te umo¿liwiaj¹ nieprzerwane magazynowanie du¿ej iloœci informacji, a tak¿e szybkie ich wyszukiwanie, sortowanie, dodawanie, edycjê oraz usuwanie. Przedstawione aspekty s¹ bardzo trudne do zaimplementowania wewn¹trz standardowych aplikacji. 

W przypadku technologii .NET, w której prowadzony jest prezentowany projekt, standardowa komunikacja aplikacji z baz¹ danych odbywa siê za poœrednictwem protoko³u ADO.NET. Przy jego u¿yciu programista ma obowi¹zek ka¿dorazowo nawi¹zaæ po³¹czenie z baz¹, rêcznie wprowadziæ zapytanie SQL, odebraæ wynik i zapisaæ go w odpowiednim obiekcie oraz zamkn¹æ po³¹czenie. Schemat ten w znacznym stopniu utrudnia utrzymanie prawid³owego dzia³ania aplikacji w przypadku jej rozbudowy lub modyfikacji bazy danych. Napisane zapytanie SQL w ¿adnym stopniu nie jest sprawdzane ze wzglêdu na jego poprawn¹ formê, a w sytuacji zmiany przyk³adowo nazwy kolumny w wykorzystywanej bazie danych, programista w celu utrzymania prawid³owej pracy aplikacji ma obowi¹zek aktualizacji wszystkich zapytañ, które dotyczy³y zmienionej kolumny. Przedstawione zagadnienie wraz z porównaniem analogicznej operacji w technologii mapowania obiektowo-relacyjnej przedstawione zosta³o z poziomu kodu w kodzie Ÿród³owym \ref{listing:AdoEntityCompare}.

W celu przeciwdzia³ania przedstawionym problemom zdecydowano siê zastosowaæ dedykowany framework, który upraszcza developerowi przeprowadzanie wszelkich bazodanowych operacji.


\begin{lstlisting}[caption={Porównanie operacji dodania u¿ytkownika w ADO.NET oraz Entity Framework}, label={listing:AdoEntityCompare}]

//ADO.NET
//wymagane manualne dodanie pliku konfiguracji po³¹czenia
SqlConnection connection = 
    new SqlConnection(connectionString);
SqlCommand command = 
    new SqlCommand(@"INSERT INTO [TestDb].[Users]  
    VALUES (@Login, @Password)", connection);           
command.Parameters.Add(
    new SqlParameter("Login", "TestLogin"));
command.Parameters.Add(
    new SqlParameter("Password","TestPa$$"));            
connection.Open();
command.ExecuteNonQuery();
connection.Close();

//Entity Framework
// EF automatycznie odczyta plik konfiguracji po³¹czenia
MyEntities dataContext = new MyEntities();
TestUser newUser = new TestUser
{ Login = "TestLogin", Password = "TestPa$$word" };
dataContext.Users.Add(newUser);
dataContext.SaveChanges(); 
\end{lstlisting}

\subsubsection{Zastosowane narzêdzie ORM – Entity Framework} 

Entity Framework jest to dedykowane dla platformy .NET narzêdzie mapowania obiektowo-relacyjnego, które wspiera budowê trójwarstwowych aplikacji bazodanowych. Budowa obiektowego modelu bazy danych w prezentowanym frameworku mo¿e przebiegaæ w zale¿noœci od potrzeb trzema œcie¿kami.

Pierwsz¹ opcj¹ jest podejœcie Database First, które okazuje siê przydatne w sytuacji, gdy obecna jest dzia³aj¹ca fizycznie baza danych. W tym przypadku, korzystaj¹c z wbudowanego we framework kreatora, istnieje mo¿liwoœæ okreœlenia lokalizacji bazy oraz automatycznego jej mapowania, w wyniku którego wygenerowane zostaj¹ potrzebne klasy obiektowego modelu bazy danych.

Kolejn¹ metod¹ jest Code First umo¿liwiaj¹ce utworzenie fizycznego modelu bazy danych na podstawie w³asnorêcznie napisanych klas w jêzyku C\# wraz z jej odpowiednimi adnotacjami \cite{AdnotacjeCodeFirst}.

Ostatnie podejœcie to Model First, które polega na zbudowaniu fizycznego modelu bazy danych pos³uguj¹c siê wbudowanemu we framework Designerowi, który w znacznym stopniu u³atwia tworzenie encji oraz w³aœciwoœci bazy danych. Œcie¿ka ta jest wykorzystywana w sytuacji posiadania wy³¹cznie schematu bazy danych. Ze zbudowanego modelu generowany jest fizyczny model bazy danych jak i równie¿ klasy, które reprezentuj¹ model obiektowy.

\subsubsection{Stosowanie poleceñ bazodanowych ze strony projektu C\# za pomoc¹ Linq to Entities}

Zastosowane narzêdzie Entity Framework nie tylko w znacznym stopniu upraszcza po³¹czenie bazy danych z projektem programistycznym ale tak¿e umo¿liwia w nim proste i intuicyjne wykonywanie poleceñ bazodanowych. W projekcie w celu zaimplementowania za³o¿onych funkcjonalnoœci stosowano trzy podstawowe polecenia modyfikuj¹ce zawartoœæ bazy: Insert, Update oraz Delete. Entity Framework domyœlnie zawiera modu³ \textsl{LINQ to Entities}, który umo¿liwia wykorzystanie sk³adni technologii LINQ \cite{LINQ} do operowania na bazodanowym Ÿródle danych.

W celu wykonania polecenia SELECT zwracaj¹cego rekordy z bazy danych nale¿y za pomoc¹ przedstawionego w kodzie Ÿród³owym \ref{listing:SelectOpis} schematu wybraæ nazwê tabeli z obiektu kontekstu wygenerowanego przez Entity Framework, a nastêpnie u¿yæ polecenia \textsl{where} definiuj¹cego wyszukiwan¹ zale¿noœæ. Finalnie poleceniem \textsl{select} nastêpuje ustalenie zdefiniowanej wczeœniej zwracanej zmiennej, w której przechowywane s¹ wyszukane elementy. Tym sposobem dane przechowywane w bazie danych poddane zostaj¹ translacji na poziom obiektów, z których mo¿liwe jest korzystanie z poziomu C\# w sposób standardowy.

\begin{lstlisting}[caption= {Opis polecenia select}, label={listing:SelectOpis}]
var exampleQuerry = (from records in _context.TableName
		where table.ColumnName == _valueToFind
		select records);
\end{lstlisting}

Edycja danych znajduj¹cych siê w bazie danych z poziomu projektu programistycznego realizowana jest poprzez modyfikacjê opisanego polecenia \textsl{SELECT}. Modyfikacja ta polega na przekszta³ceniu typu otrzymanego obiektu na typ klasy modelu Entity, który reprezentuje edytowan¹ bazodanow¹ tabelê. W przypadku operowania na jednym rekordzie, przekszta³cenie te nale¿y dokonaæ pos³uguj¹c siê metod¹ \textsl{SingleOrDefault}, natomiast w przypadku wielu rekordów metod¹ \textsl{ToList}, która dokona konwersji na listê obiektów po¿¹danego typu. Do takiego utworzonego obiektu, programista ma mo¿liwoœæ odwo³ywania siê i dokonywania zmian w standardowy dla jêzyka C\# sposób. Po operacji modyfikacji, wszystkie zmiany nale¿y potwierdziæ metod¹ \textsl{SaveChanges} na obiekcie modelu Entity, która uaktualnia zmodyfikowane elementy na poziomie bazy danych.

Dodanie rekordu do bazy danych jest operacj¹, które nie wymaga znajomoœci sk³adni LINQ to Entities. Operacja ta polega na utworzeniu obiektu klasy wygenerowanej przez Entity Framework, która reprezentuje bazodanow¹ tabelê, do której nowy rekord ma byæ dodany, a nastêpnie uzupe³nieniu jego elementów danymi. Tak zbudowany obiekt nale¿y dodaæ do obiektu kontekstu, odwo³uj¹c siê do jego w³aœciwoœci o nazwie interesuj¹cej nas tabeli bazy danych, a nastêpnie w parametrze metody \textsl{Add} umieœciæ wczeœniej zbudowany obiekt. Dokonane zmiany, analogicznie jak w przypadku edycji danych nale¿y potwierdziæ na obiekcie kontekstu. Przedstawienie opisanej operacji z poziomu kodu, dostêpne jest równie¿ do wgl¹du w drugiej czêœci listingu \ref{listing:AdoEntityCompare}.

\section{Automatyzacja wydawania kolejnych wersji aplikacji}
\subsection{Continuous Integration/Continuous Delivery/Continuous Deployment}

Ci¹g³a integracja (ang. Continuous Integration, CI) jest praktyk¹ stosowan¹ podczas procesu wytwarzania oprogramowania. Cz³onkowie zespo³ów programistycznych synchronizuj¹ zmiany w kodzie Ÿród³owym przynajmniej raz dziennie, d¹¿¹c do wielokrotnej intagracji jednego dnia. Ka¿da integracja weryfikowana jest przez narzêdzia do automatyzacji (ang. build automation), takie jak Jenkins. Dla ka¿dej zmiany kodu Ÿród³owego w repozytorium kompilacja, czy testy jednostkowe mog¹ zostaæ wykonane automatycznie, co prowadzi do wczeœniejszego wykrywania b³êdów. Stosowanie tej praktyki umo¿liwia zmniejszenie iloœci pracy podczas ³¹czenia zmian projektów programistycznych \cite{ci}.

Ci¹g³a dostawa (ang. Continuous Delivery) jest podejœciem w in¿ynierii oprogramowania którego podstawowym za³o¿eniem jest zapewnienie wysokiej jakoœci oraz poprawnoœci dzia³ania cyklicznie wytwarzanego oprogramowania. Wynikiem procesu jest stabilna wersja oprogramowania, która mo¿e zostaæ dostarczona do klienta w dowolnym czasie \cite{cdel}. Rozwiniêciem praktyki jest ci¹g³e wdra¿anie (ang. Continuous Deployment), które umo¿liwia automatyczne wydawanie aplikacji do lini produkcyjnej \cite{cdr}.

\subsection{Programy i wtyczki u¿yte w Jenkins}

\subsubsection{SonarQube}

SonarQube jest darmow¹, wieloplatformow¹ aplikacj¹ s³u¿¹c¹ do zarz¹dzania jakoœci¹ kodu Ÿród³owego. Zosta³a napisan¹ w jêzykach Java i Ruby. Domyœlnie dzia³a na porcie 9000. Posiada szereg wtyczek zapewniaj¹cych wsparcie dla popularnych jêzyków programowania takich jak Java, C++, Objective-C, C\# czy PHP \cite{SonarLang}, które umo¿liwiaj¹ statyczn¹ analizê kodu. W przypadku niniejszego projektu u¿yto wtyczkê SonarQube Scanner for MSBuild, która zawiera zbiór zasad okreœlaj¹cych poprawnoœæ kodu w jêzyku C\#. Wsparcie SonarQube w Jenkins'ie, umo¿liwia wykorzystywanie narzêdzia w planach ci¹g³ej integracji \cite{MsScaner}. Podstawowe parametry wyliczane w analizie s¹ nastêpuj¹ce:

\begin{itemize}
\item \textsl{Liczba linii kodu Ÿród³owego}
\item \textsl{Liczba plików i katalogów}
\item \textsl{Liczba funkcji, klas}
\item \textsl{Liczba powtórzeñ bloków kodu}
\item \textsl{Liczba potencjalnych b³êdów i przybli¿ony czas potrzebny do ich rozwi¹zania}
\item \textsl{Ocena jakoœci w skali SQALE}
\end{itemize}

Przyk³adowy raport analizy kodu niniejszego projektu zosta³ przedstawiony na rysunku \ref{rys:RaportAnalizy}.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=1\textwidth]{sonarraport.jpg}
%    \caption{Raport statycznej analizy kodu Ÿród³owego, ród³o: Opracowanie w³asne.}
%    \label{rys:RaportAnalizy}
%\end{figure}

SonarQube na podstawie raportu analizy dokonuje oceny jakoœci kodu w skali SQALE (ang. Software Quality Assessment based on Lifecycle Expectations). Ocena jest wyliczana ze wzoru \cite{SQALE}:

\begin{center}
$\displaystyle\frac{\mbox{Liczba dni potrzebnych do naprawienia b³êdów}}{\mbox{Liczba dni potrzebnych do naprawy b³êdu z jednej linii kodu * Liczba linii kodu Ÿród³owego}}$
\end{center}

Wynik dzia³ania jest przedstawiany w procentach. Im mniejsza wartoœæ, tym jakoœæ kodu jest wy¿sza. Oceny odpowiadaj¹ce wartoœciom wyliczonym ze wzoru s¹ nastêpuj¹ce:

\begin{itemize}
\item \textsl{A - mniej ni¿ 10\% }
\item \textsl{B - od 11\% do 20\%}
\item \textsl{C - od 21\% do 50\%}
\item \textsl{D - od 51\% do 100\%}
\item \textsl{E - powy¿ej 100\%}
\end{itemize}

Potencjalne b³êdy zapisywane s¹ na liœcie zadañ, pokazanej na rysunku \ref{rys:SonarIssues}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{SonarIssues.jpg}
    \caption{Lista zadañ w SonarQube, ród³o: Opracowanie w³asne.}
    \label{rys:SonarIssues}
\end{figure} 

\subsection{Schemat budowania projektu}

Kolejne wersje niniejszego projektu s¹ wydawane zgodnie z zasadami Continuous Delivery. Utworzono plan w Jenkins'ie który wykonuje nastêpuj¹ce zadania:

\begin{itemize}
\item \textsl{Pobranie kodu Ÿród³owego} 

\tab Pliki zawieraj¹ce kod Ÿród³owy s¹ pobierane z repozytorium do obszaru roboczego.

\item \textsl{Rozpoczêcie statycznej analizy kodu} 

\tab Za pomoc¹ wtyczki SonarQube Scanner for MSBuild, SonarQube Scanner rozpoczyna statyczn¹ analizê kodu Ÿród³owego.

\item \textsl{Aktualizacja bibliotek} 

\tab W projekcie zosta³y u¿yte zewnêtrzne biblioteki takie jak PDFSharp \& Migradoc Foundation. Kod zostanie skompilowany poprawnie po przywróceniu (ang. restore) bibliotek przy u¿yciu NuGet Package Manager.

\item \textsl{Kompilacja kodu Ÿród³owego} 

\tab Kod Ÿród³owy zostaje skompilowany przy u¿yciu MSBuild, który jest kompilatorem zintegrowanego œrodowiska programistycznego Visual Studio. 

\item \textsl{Raport analizy} 

\tab Raport statycznej analizy kodu zostaje opublikowany w SonarQube. 

\item \textsl{Utworzenie paczki zip} 

\tab Je¿eli kompilacja kodu siê powiod³a, zostaje utworzone archiwum w formacie zip. Zawiera plik wykonywalny, w formacie exe oraz niezbêdne do poprawnego dzia³ania aplikacji pliki. Paczka zawieraj¹ca kolejn¹ wersjê aplikacji, mo¿e zostaæ dostarczona do potencjalnego klienta w dowolnym czasie.

\end{itemize}

Rysunek \ref{rys:JenkinsSek} przedstawia stronê wygenerowan¹ dla planu.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{jenkinsek.jpg}
    \caption{Plan ci¹g³ej integracji w Jenkins'ie, ród³o: Opracowanie w³asne.}
    \label{rys:JenkinsSek}
\end{figure}


\section{Testowanie aplikacji}
\subsection{Przeprowadzenie operacji logowania u¿ytkownika}

Podstawowym modu³em ka¿dej aplikacji wspieraj¹cej pracê wielu u¿ytkowników na ich dedykowanych kontach jest modu³ logowania. Po uruchomieniu aplikacji, która jest przedmiotem projektu, oczom u¿ytkownika ukazuje siê widocznie na rysunku \ref{rys:UzytkownikLogowanie} okno, którego zadaniem jest sprawdzenie jego to¿samoœci oraz w sytuacji jej potwierdzenia, prze³¹czenie do odpowiedniego okna g³ównego aplikacji, w zale¿noœci od posiadanych uprawnieñ. 

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.85\textwidth]{UzytkownikLogowanie.jpg}
    \caption{Okno procesu logowania, ród³o: Opracowanie w³asne.}
    \label{rys:UzytkownikLogowanie}
\end{figure}

Proces logowania od strony u¿ytkownika polega na wprowadzeniu z poziomu klawiatury swojej nazwy konta sk³adaj¹cej siê z imienia oraz nazwiska oddzielonych kropk¹ oraz has³a, które wybrano do zabezpieczenia swojego konta. Aplikacja na podstawie tych informacji przeprowadza operacjê ich weryfikacji, komunikuj¹c siê z baz¹ danych i wyszukuj¹c w odpowiednich tabelach rekordy, które pasuj¹ do otrzymanego schematu. W zale¿noœci od rezultatu tej akcji, u¿ytkownikowi zwracana jest odpowiednia odpowiedŸ. 

W sytuacji podania poprawnego loginu oraz has³a, aplikacja ukrywa okno logowania oraz uruchamia odpowiednie dla posiadanych uprawnieñ okno g³ówne. Istniej¹ jednak inne schematy przeprowadzenia operacji logowania, takie jak wpisanie b³êdnego  has³a lub loginu, nie uzupe³nienie nazwy u¿ytkownika lub pierwsze logowanie na konto, które zgodnie z ustalonymi przez zespó³ za³o¿eniami projektowymi ma umo¿liwiaæ ustalenie has³a przez loguj¹cego siê u¿ytkownika.

Wpisanie b³êdnego has³a lub nazwy konta wychwytywane jest przez mechanizm modu³u logowania, który zwraca informacjê ukazan¹ na rysunku \ref{rys:UzytkownikLogowanieZleDane} o problemie wraz z jego opisem. W celu zwiêkszenia bezpieczeñstwa wypisywana jest ogólna informacja o otrzymaniu b³êdnych danych, a nie wyszczególniona, która informacja zosta³a podana b³êdnie.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{UzytkownikLogowanieZleDane.jpg}
    \caption{Informacja otrzymania b³êdnych danych podczas operacji logowania, ród³o: Opracowanie w³asne.}
    \label{rys:UzytkownikLogowanieZleDane}
\end{figure}

Pierwsze logowanie jest specyficzn¹ form¹ logowania, w którym u¿ytkownik posiada obowi¹zek wpisania has³a, z którego bêdzie korzysta³ w pracy z aplikacj¹. W chwili wpisania nazwy u¿ytkownika, program w tle przeprowadza operacjê walidacji statusu konta i w sytuacji wykrycia, i¿ u¿ytkownik loguje siê pierwszy raz, wyœwietla stosown¹ informacjê przedstawion¹ na rysunku \ref{rys:UzytkownikLogowaniePierwsze}, która instruuje go o dalszych krokach. Ustalone przez u¿ytkownika has³o ma obowi¹zek spe³niaæ okreœlone jego zasady bezpieczeñstwa dotycz¹ce posiadania przynajmniej oœmiu znaków, co najmniej jednej du¿ej oraz ma³ej litery, a tak¿e cyfry. U¿ytkownik w sytuacji wpisania has³a, nie spe³niaj¹cej powy¿szej polityki bezpieczeñstwa poinformowany zostanie stosown¹ informacj¹, która przedstawiona zosta³a na rysunku \ref{rys:UzytkownikLogowanieSilaHasla}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{UzytkownikLogowaniePierwsze.jpg}
    \caption{Okno informacji podczas pierwszego logowania, ród³o: Opracowanie w³asne.}
    \label{rys:UzytkownikLogowaniePierwsze}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{UzytkownikLogowanieSilaHasla.jpg}
    \caption{Okno informuj¹ce o polityce bezpieczeñstwa hase³, ród³o: Opracowanie w³asne.}
    \label{rys:UzytkownikLogowanieSilaHasla}
\end{figure}

\subsection{Zarz¹dzanie kontem sprzedawcy oraz administratora  (obs³uga)}

\subsection{Tworzenie nowej propozycji cenowej}

Modu³ tworzenia nowej propozycji cenowej umo¿liwia u¿ytkownikowi aplikacji przeprowadzenie procesu utworzenia schematu wymaganych przez klienta us³ug wraz z ich zapisem do bazy danych. Tym sposobem wszelkie ustalenia dokonane z potencjalnym klientem zapisywane s¹ na centralnym serwerze, z którego w razie potrzeby mo¿na wybran¹ propozycjê pobraæ i wygenerowaæ jej plik w formacie PDF lub dokonaæ jej edycji.

W czasie kontaktu sprzedawcy z klientem, chc¹c przedstawiæ ofertê cenow¹ dotycz¹c¹ organizowanego przez klienta wydarzenia, sprzedawca posiada w menu g³ównym aplikacji opcjê stworzenia nowej propozycji cenowej. W sytuacji wybrania przedstawionej opcji, oczom sprzedawcy ukazuje siê forma przeznaczona do wpisania wymaganych danych. Forma ta przez wzgl¹d na kilka typów us³ug podzielona zosta³a na piêæ zak³adek, z których ka¿da zawiera odpowiednia pola, umo¿liwiaj¹ce ustalenie wszelkich elementów konkretnej us³ugi.

\subsubsection{Opis klienta}
\label{dzial:OpisKlientaUzytkownik}

Pierwsza zak³adka, której okno graficzne dostêpnej jest do wgl¹du przy rysunku \ref{rys:UzytkownikNowaPropozycjaTab1} zawiera wszelkie informacje dotycz¹ce danych osobowych sprzedawcy, klienta oraz ogólnych danych o organizowanym wydarzeniu. Dane osobowe sprzedawcy oraz informacje o firmie, któr¹ reprezentuje, pobierane s¹ automatycznie z bazy danych. Operacja ta jest mo¿liwa do wykonania dziêki przechowywaniu w programie informacji o tym, na jakie konto u¿ytkownik zosta³ zalogowany. Wszelkie pozosta³e dane sprzedawca ma obowi¹zek uzupe³niæ samodzielnie bazuj¹c na potrzebach klienta.

\begin{itemize}
\item \textsl{NAZWA FIRMY} 

\tab Przez wzgl¹d na mo¿liwoœæ obs³ugi klientów biznesowych wprowadzone zosta³o pole umo¿liwiaj¹ce wpisanie nazwy firmy, któr¹ klient reprezentuje. W celu jednoznacznej identyfikacji ka¿dej propozycji cenowej, uznano i¿ pole to bêdzie jedn¹ z kolumn listy propozycji okna g³ównego.

\item \textsl{ADRES KLIENTA} 

\tab Pole to przeznaczone jest do wpisania adresu klienta zarówno w przypadku osoby indywidualnej jak i firmy. Po analizie wszelkich za³o¿eñ projektowych nie dostrze¿ono koniecznoœci rozdzielenia danych adresowych - potrzebne s¹ one tylko i wy³¹cznie do opisu klienta na wygenerowanym dokumencie PDF.

\item \textsl{NIP} 

\tab NIP jest kolejnym polem opcjonalnym, które przeznaczone jest do wpisania numeru identyfikacji podatkowej. Jego wype³nienie konieczne jest wy³¹cznie w sytuacji obs³ugi klienta reprezentuj¹cego firmê. W przypadku klienta prywatnego pole te nale¿y pozostawiæ puste.

\item \textsl{TERMIN WA¯NOŒCI PROPOZYCJI}

\tab Utworzona dla klienta propozycja cenowa posiada ustalony okres wa¿noœci, który domyœlnie wykosi cztery dni od sporz¹dzenia i zapisania propozycji cenowej przez sprzedawcê. Spowodowane jest to czêstymi zmianami cenników i chêci¹ unikniêcia sytuacji, w której klient po d³ugim okresie czasu bêdzie chcia³ z posiadanej propozycji cenowej skorzystaæ. Sprzedawca dziêki modu³owi edycji propozycji posiada mo¿liwoœæ aktualizacji terminu wa¿noœci propozycji, dziêki czemu utworzona propozycja cenowa nie musi byæ tworzona ponownie od podstaw. 

\item \textsl{KONTAKT ZE STRONY ZAMAWIAJ¥CEGO}

\tab Jest to podkategoria zawieraj¹ca cztery pola tekstowe, które przeznaczone s¹ do wpisania imienia i nazwiska klienta, jego numeru telefonu oraz adresu e-mail. Ostatnie pole tekstowe (\textsl{Osoba decyzyjna}) umo¿liwia wpisanie osoby, która posiadaæ bêdzie uprawnienie do dokupywania us³ug nieuwzglêdnionych w propozycji cenowej w czasie trwania wydarzenia. Zdarza siê, i¿ podczas jego trwania, organizator chce dobraæ dla goœci dodatkowe us³ugi, które nie s¹ uwzglêdnione w ofercie, na bazie której wydarzenie jest przeprowadzane. W tej sytuacji w celu unikniêcia póŸniejszych problemów dotycz¹cych zwiêkszenia kwoty koñcowej wydarzenia, wybierana jest osoba, która decyduje jakie elementy mog¹ byæ dokupione. Ilustruj¹c tê sytuacjê mo¿na pos³u¿yæ siê przyk³adem imprezy weselnej do której b³êdnie przewidziano liczbê dostêpnych napoi. Osoba decyzyjna mo¿e tê wartoœæ zwiêkszyæ z pe³n¹ odpowiedzialnoœci¹ zwiêkszenia kosztów. Zawartoœæ pola tekstowego osoby decyzyjnej automatycznie wype³niana jest zawartoœci¹ pola tekstowego \textsl{Imiê i nazwisko}. Istnieje jednak mo¿liwoœæ, aby sprzedawca zmieni³ t¹ wartoœæ na inn¹ poniewa¿ nie zawsze osoba klienta jest osob¹ decyzyjn¹ w czasie trwania wydarzenia.

\item \textsl{TERMIN (od - do)}

\tab Pola te okreœlaj¹ datê rozpoczêcia oraz datê zakoñczenia organizowanego wydarzenia. Data rozpoczêcia odgrywa istotn¹ rolê w tworzonej propozycji przez fakt, i¿ ceny sal uzale¿nione s¹ w³aœnie od miesi¹ca, w którym dane wydarzenie bêdzie organizowane. Po wyborze daty, w polu \textsl{Miesi¹c} ukazuje siê nazwa miesi¹ca na podstawie którego dobierana bêdzie cena wybranej w póŸniejszym etapie tworzenia propozycji cenowej sali.

\item \textsl{CZAS TRWANIA (od - do)}

\tab Czas trwania definiuje planowane godziny, w czasie których przeprowadzone ma byæ wydarzenie. Bezpoœrednio odwo³uj¹ siê one do wpisanej uprzednio daty rozpoczêcia oraz zakoñczenia. Na tej podstawie mo¿liwe jest dok³adne okreœlenie okresu trwania wydarzenia.

\item \textsl{ILOŒÆ OSÓB}

\tab Pole to okreœla planowan¹ liczbê osób, które maj¹ w danym wydarzeniu uczestniczyæ. W celu weryfikacji, czy dana liczba osób fizycznie zmieœci siê na wybranej sali, sprzedawca ma mo¿liwoœæ pos³u¿yæ siê dostêpn¹ poni¿ej prezentowanych pól tabel¹ pomocnicz¹.

\item \textsl{STATUS PROPOZYCJI}

\tab Pole to jest polem informacyjnym, który opisuje status tworzonej propozycji. Domyœlnym statusem podczas stworzenia nowej propozycji jest \textsl{"Nowa"}, któr¹ sprzedawca w sytuacji oczekiwania na decyzjê klienta ma obowi¹zek zmieniæ na \textsl{"W trakcie realizacji"}, natomiast po sfinalizowaniu transakcji oznaczyæ jako \textsl{"Zrealizowana"}. Status propozycji cenowej wyœwietlany jest na liœcie wszystkich propozycji w oknie g³ównym.

\item \textsl{TABELA SAL}

\tab W zale¿noœci od wybranej z listy rozwijanej sali oraz uprzednio wybranej dacie rozpoczêcia wydarzenia, sprzedawca ma mo¿liwoœæ otrzymania informacji o cenie sali, jej powierzchni oraz liczbie dostêpnych miejsc. Informacje te w czasie ustalania szczegó³ów transakcji umo¿liwiaj¹ wybór optymalnego dla potrzeb klienta pomieszczenia, w którym przez wzgl¹d na liczbê dostêpnych miejsc bêdzie mo¿na rozlokowaæ wszystkich uczestników. Wybrana z listy rozwijanej sala wraz z dat¹ rozpoczêcia jednoznacznie identyfikuje cenê oraz nazwê pomieszczenia, której rekord w sposób automatyczny dodawany jest jako pierwszy w kolejnej zak³adce opisuj¹cej szczegó³y rezerwacji.

\end{itemize}

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{UzytkownikNowaPropozycjaTab1.jpg}
    \caption{Okno tworzenia propozycji cenowej. Zak³adka kontakt ze strony zamawiaj¹cego, ród³o: Opracowanie w³asne.}
    \label{rys:UzytkownikNowaPropozycjaTab1}
\end{figure}

\subsubsection{Sala i jej wyposa¿enie}
\label{dzial:SalaIWyposazenieUzytkownik}

Druga zak³adka modu³u tworzenia nowej propozycji cenowej widoczna pod rysunkiem \ref{rys:UzytkownikNowaPropozycjaTab2}, dotyczy szczegó³ów rezerwacji dotycz¹cych sali, jej dodatkowego wyposa¿enia oraz cen poszczególnych elementów. Na tym etapie negocjowany jest równie¿ rabat dotycz¹cy finalnej ceny wybranej przez klienta sali.

\begin{itemize}
\item \textsl{WYBÓR WYPOSA¯ENIA}

\tab Dodanie elementów wyposa¿enia dodatkowego sali umo¿liwiaj¹ rozwijane listy, które zawieraj¹ dostêpne dla hotelu elementy, z których klient mo¿e skorzystaæ. Po jego wybraniu, sprzedawca zobowi¹zany jest na drodze negocjacji ustaliæ z klientem \textsl{cenê jednostkow¹ brutto}, podaæ jego \textsl{iloœæ} oraz \textsl{liczbê dni}, przez które bêdzie u¿ywane. Tak wpisane informacje zostaj¹ przeliczane, a ich wynik wyœwietlany zostaje w polu \textsl{wartoœæ brutto}. \textsl{Ceny jednostkowe netto} oraz ca³kowite \textsl{wartoœci netto} s¹ równie¿ obliczane automatycznie na podstawie podanych cen brutto oraz ustalonej równie¿ z poziomu rozwijanej listy stawki VAT.

\item \textsl{RABATY}

\tab Ceny tabelaryczne wynajmowanych sal s¹ cenami umownymi, narzuconymi przez menad¿era odgórnie. Sprzedawca ma jednak prawo ich obni¿ania na drodze negocjacji w celu przedstawienia klientowi korzystnej oferty na tle konkurencji. Po operacji wyboru sali, w polu \textsl{"Standardowa cena sali"} widoczna jest jej cena, któr¹ za pomoc¹ znajduj¹cego siê poni¿ej pola mo¿na redukowaæ. W chwili zmiany wartoœci rabatu, wszelkie wartoœci cenowe jego dotycz¹ce s¹ w czasie rzeczywistym  odœwie¿ane, co u³atwia ich kontrolê przez sprzedawcê.
\end{itemize}

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{UzytkownikNowaPropozycjaTab2.jpg}
    \caption{Okno tworzenia propozycji cenowej. Zak³adka sali i jej wyposa¿enia, ród³o: Opracowanie w³asne.}
    \label{rys:UzytkownikNowaPropozycjaTab2}
\end{figure}

\subsubsection{Us³ugi gastronomiczne}
\label{dzial:UslugiGastronomiczneUzytkownik}

\tab Kolejnym krokiem w czasie procesu tworzenia propozycji cenowej jest wybór us³ug zwi¹zanych z gastronomi¹. Zasada dzia³ania us³ug gastronomicznych, których okno widoczne jest pod rysunkiem \ref{rys:UzytkownikNowaPropozycjaTab3}, podobna jest do poprzedniej zak³adki, z t¹ ró¿nic¹ i¿ wewnêtrzne mechanizmy sprawdzaj¹ce powi¹zania s¹ znacznie bardziej skomplikowane.

\begin{itemize}
\item \textsl{WYBÓR ELEMENTÓW GASTRONOMICZNYCH}

\tab Wszelkie elementy gastronomiczne przez wzgl¹d na ich iloœæ podzielone zosta³y na kategorie, które umo¿liwiaj¹ proste wyszukanie interesuj¹cego elementu. W celu dodania elementu gastronomicznego nale¿y z pierwszej rozwijanej listy wybraæ interesuj¹c¹ kategoriê oraz z drugiej listy wybraæ konkretny dla tej kategorii element. Po wykonaniu przedstawionych operacji, aktualne ceny jednostkowe wraz z podatkiem VAT zostaj¹ automatycznie uzupe³niane, co usuwa ze sprzedawcy koniecznoœæ ich manualnego sprawdzania. Po wyborze iloœci oraz liczby dni przez które produkt ma byæ dostêpny, z poziomu tabeli wyœwietlana zostaje jego zsumowana wartoœæ.

\item \textsl{MAR¯E}

Pobierane z bazy danych ceny produktów s¹ cenami przyjêtymi jako minimalne ceny po których produkt mo¿e zostaæ sprzedany. W celu wygenerowania wiêkszego przychodu sprzedawca ma mo¿liwoœæ podwy¿szenia ceny produktu poprzez ustalenie wielkoœci jego mar¿y, których domyœlne wartoœci ustalone zosta³y przez menad¿era sprzeda¿y. Przedstawiane mar¿e podzielone zosta³y na piêæ kategorii przez wzgl¹d na ich specyfikê - dla przyk³adu mar¿a na napoje alkoholowe jest z definicji znacznie wiêksza ni¿ na potrawy bufetowe lub produkty niskobud¿etowe.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{UzytkownikNowaPropozycjaTab3.jpg}
    \caption{Okno tworzenia propozycji cenowej. Zak³adka elementów gastronomicznych, ród³o: Opracowanie w³asne.}
    \label{rys:UzytkownikNowaPropozycjaTab3}
\end{figure}

\end{itemize}

\subsubsection{Us³ugi noclegowe}
\label{dzial:UslugiNoclegoweUzytkownik}

Zak³adka us³ug noclegowych widoczna pod rysunkiem \ref{rys:UzytkownikNowaPropozycjaTab4} opisuje liczbê oraz rodzaj wybranych pokoi hotelowych. Lista dostêpnych pokoi wraz z wyszczególnionymi cenami automatycznie dostarczana jest do okna z bazy danych. Rol¹ sprzedawcy jest wybór odpowiedniej ich iloœci oraz liczby dni. Jedyn¹ mo¿liwoœci¹ obni¿enia ustalonych przez menad¿era cen jest ustalenie rabatu, który jednakowo obowi¹zuje wszystkie rodzaje pokoi. Po wpisaniu odpowiednich wartoœci, wewnêtrzne mechanizmy programu przeliczaj¹ wszystkie wartoœci umo¿liwiaj¹c podgl¹d ich zsumowanych wartoœci netto i brutto.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{UzytkownikNowaPropozycjaTab4.jpg}
    \caption{Okno tworzenia propozycji cenowej. Zak³adka dotycz¹ca us³ug noclegowych, ród³o: Opracowanie w³asne.}
    \label{rys:UzytkownikNowaPropozycjaTab4}
\end{figure}

\subsubsection{Us³ugi dodatkowe i forma p³atnoœci}
\label{dzial:UslugiDodatkoweIPlatnoscUzytkownik}

Ostatni¹ zak³adk¹ procesu tworzenia nowej propozycji cenowej widoczn¹ pod rysunkiem \ref{rys:UzytkownikNowaPropozycjaTab5} jest zak³adka umo¿liwiaj¹ca ustalenie finalnej formy w której realizowana bêdzie zap³ata, dodanie indywidualnie ustalanych z klientem elementów, które nie s¹ dostêpne w zakresie standardowych us³ug oferowanych przez sieæ hotelow¹ oraz rezerwacjê miejsc parkingowych dla uczestników organizowanego wydarzenia. Przez wzgl¹d, i¿ przedstawiana zak³adka jest ostatni¹ czêœci¹ tworzenia propozycji cenowej, zawiera tak¿e pola zawieraj¹ce ca³kowity koszt netto oraz brutto wszystkich wybranych wczeœniej us³ug.

\begin{itemize}
\item \textsl{US£UGI DODATKOWE}

\tab W celu realizacji procesu dodania us³ugi niestandardowej, pracownik ma obowi¹zek uzyskania od prze³o¿onego informacji dotycz¹cej fizycznej mo¿liwoœci jej realizacji podczas organizowanego wydarzenia i w sytuacji akceptacji mo¿e zapisaæ jej nazwê w polu \textsl{Rodzaj us³ugi}, uzupe³niæ ustalon¹ cenê brutto wraz z wartoœci¹ VAT oraz wybraæ jej iloœæ oraz liczbê dni. Tak utworzony rekord us³ugi zostanie, analogicznie jak w przypadku poprzednich zak³adek odpowiednio przeliczony i wyœwietlony w polach dotycz¹cych wartoœci.

\tab Rezerwacja parkingu jest elementem nieco prostszym. Obowi¹zkiem sprzedawcy jest ustalenie tylko i wy³¹cznie rodzaju wybranego parkingu, dostêpnego z poziomu rozwijanej listy pierwszego wiersza okna oraz uzupe³nienie jego iloœci oraz liczby dni.
\end{itemize}

\begin{itemize}
\item \textsl{FORMA ZAP£ATY}

\tab Podkategoria ta jest finalnym elementem tworzonej propozycji cenowej. Umo¿liwia ona sprzedawcy wybór formy w jakiej klient chce dokonaæ p³atnoœci, nazwy us³ugi zapisanej na fakturze oraz sposobu zap³aty za zamówienia indywidualne oraz parking. Opcje wszystkich przedstawionych elementów dostêpne s¹ z poziomu rozwijanych list, umo¿liwiaj¹c tym samym sprzedawcy bardzo szybk¹ mo¿liwoœæ ich wyboru.

\begin{figure}[ht]
    \centering
    \includegraphics[width=1\textwidth]{UzytkownikNowaPropozycjaTab5.jpg}
    \caption{Okno tworzenia propozycji cenowej. Zak³adka dotycz¹ca us³ug dodatkowych oraz formê zap³aty za organizowane wydarzenie, ród³o: Opracowanie w³asne.}
    \label{rys:UzytkownikNowaPropozycjaTab5}
\end{figure}

\end{itemize}

\subsubsection{Zapis nowej propozycji cenowej}

Operacja zapisu nowej propozycji cenowej mo¿liwa jest do wykonania w ka¿dej chwili tworzenia propozycji. Sprzedawca nie ma obowi¹zku tworzenia pe³nego dokumentu, który w sposób natychmiastowy przekazywany bêdzie klientowi. Dostêpna z poziomu menu opcja edycji istniej¹cej propozycji umo¿liwia jej finalne zakoñczenie w dowolnym czasie. W sytuacji chêci zapisu tworzonej propozycji, sprzedawca zobowi¹zany jest nacisn¹æ przycisk \textsl{Zapisz propozycjê}, który po odpowiedniej konwersji danych zapisze wszystkie wymagane do póŸniejszej edycji elementy do bazy danych. Lokalizacja przycisku umiejscowiona jest w prawym górnym rogu ka¿dej zak³adki tworzenia nowej propozycji cenowej. Jej wygl¹d dostêpny jest do wgl¹du w przywo³anym ju¿ rysunku \ref{rys:UzytkownikNowaPropozycjaTab5}.

\subsection{Edycja istniej¹cej propozycji cenowej}
Edycja istniej¹cej propozycji cenowej odbywa siê poprzez zaznaczenie w oknie g³ówny programu wybranej propozycji cenowej, a nastêpnie z menu wybrania "Edytuj". U¿ytkownik zostanie przeniesiony do okna tworzenia nowej propozycji, ale ju¿ z wype³nionymi wczeœniej polami. Sprzedawca ma mo¿liwoœæ dodawania nowych produktów a usuwanie odbywa siê poprzez wybranie pustego pola na liœcie rozwijalnej. Mo¿na to zaobserwowaæ na rysunku \ref{rys:editProp}
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.9\textwidth]{editpro.jpg}
    \caption{Edycja propozycji, ród³o: Opracowanie w³asne.}
	\label{rys:editProp}
\end{figure}

\subsection{Tworzenie pliku PDF istniej¹cej propozycji cenowej}

Aby zapisaæ propozycjê cenow¹ do pliku PDF, nale¿y wybraæ z menu rozwijanego \textit{Menu} opcjê \textit{Lista propozycji}. 

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.25\textwidth]{pdf.jpg}
%    \caption{Wyœwietlanie listy propozycji cenowych, ród³o: Opracowanie w³asne.}
%	\label{rys:ListaPropozycji}
%\end{figure}

Rysunek  Po klikniêciu przycisku \textit{Zapisz do PDF}, pojawia siê dialog wyboru plików. U¿ytkownik wpisuje nazwê pliku oraz lokalizacjê zapisu. 

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.75\textwidth]{df2.jpg}
%    \caption{Zapis propozycji cenowej do pliku PDF, ród³o: Opracowanie w³asne.}
%	\label{rys:ZapisDoPdf}
%\end{figure}

Je¿eli operacja siê powiod³a, u¿ytkownik otrzyma komunikat.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.25\textwidth]{pdf3.jpg}
%    \caption{Poprawny zapis propozycji cenowej do pliku PDF, ród³o: Opracowanie w³asne.}
%	\label{rys:ZapisDoPdf2}
%\end{figure}

\subsection{Modyfikacja kont u¿ytkowników/sprzedawców}
\subsubsection{Dodawanie konta}

Aby utworzyæ nowe konto u¿ytkownika, w oknie g³ównym administrator wybiera z menu rozwijanego \textit{U¿ytkownicy} opcjê \textit{Dodaj}.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{dodaj.jpg}
%    \caption{Dodawanie u¿ytkownika z poziomu menu rozwijanego, ród³o: Opracowanie w³asne.}
%	\label{rys:DodajUzytkownika}
%\end{figure}

Nastêpnie pojawia siê okno do którego wpisywane s¹ dane u¿ytkownika. Aby dodaæ u¿ytkownika nale¿y klikn¹æ przycisk \textit{Dodaj}.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{dodaj2.jpg}
%    \caption{Dodawanie u¿ytkownika, ród³o: Opracowanie w³asne.}
%	\label{rys:DodajU¿ytkownika2}
%\end{figure}

Je¿eli dodawanie zakoñczono sukcesem, u¿ytkownik otrzyma komunikat.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{dodaj3.jpg}
%    \caption{Komunikat o poprawnym utworzeniu konta, ród³o: Opracowanie w³asne.}
%	\label{rys:DodajUzytkownika3}
%\end{figure}

W przeciwnym wypadku, u¿ytkownik otrzyma komunikat o b³êdzie.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{dodaj4.jpg}
%    \caption{Komunikat o b³êdach podczas próby utworzenia konta, ród³o: Opracowanie w³asne.}
%	\label{rys:DodajUzytkownika4}
%\end{figure}

\subsubsection{Edycja konta}

Aby edytowaæ dane u¿ytkowników, w oknie g³ównym administrator wybiera z menu rozwijanego \textit{U¿ytkownicy} opcjê \textit{Edytuj}.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{edytujuz.jpg}
%    \caption{Edyja danych u¿ytkowników z poziomu menu rozwijanego, ród³o: Opracowanie w³asne.}
%	\label{rys:EdytujUzytkownika}
%\end{figure}

Nastêpnie zostanie otwarte nowe okno, które wyœwietla dane u¿ytkowników w tabeli. Aby edytowaæ dane nale¿y zaznaczyæ wybran¹ komórkê, wpisaæ tekst.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.75\textwidth]{edytujuz2.jpg}
%    \caption{Okno edycji danych u¿ytkowników, ród³o: Opracowanie w³asne.}
%	\label{rys:EdytujUzytkownika2}
%\end{figure}

\subsubsection{Usuwanie konta}

Aby usun¹æ konto u¿ytkownika, w oknie g³ównym administrator wybiera z menu rozwijanego \textit{U¿ytkownicy} opcjê \textit{Usuñ}.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{rm.jpg}
%    \caption{Usuwanie u¿ytkowników z poziomu menu rozwijanego, ród³o: Opracowanie w³asne.}
%	\label{rys:UsunUzytkownika}
%\end{figure}

Nastêpnie pojawia siê okno, w którym z listy rozwijanej administrator wybiera konto. Aby usun¹æ konto nale¿y klikn¹æ przycisk \textit{Usuñ}.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{rm2.jpg}
%    \caption{Okno usuwanie u¿ytkowników, ród³o: Opracowanie w³asne.}
%	\label{rys:UsunUzytkownika2}
%\end{figure}

Je¿eli usuwanie powiod³o siê, zostaje wyœwietlony komunikat.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{rm3.jpg}
%    \caption{Komunikat o poprawnym usuniêciu konta u¿ytkownika, ród³o: Opracowanie w³asne.}
%	\label{rys:UsunUzytkownika3}
%\end{figure}

\subsubsection{Resetowanie hase³}


Aby zresetowaæ has³o u¿ytkownika, w oknie g³ównym administrator wybiera z menu rozwijanego \textit{U¿ytkownicy} opcjê \textit{Resetuj has³o}.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{resetuj.jpg}
%    \caption{Resetowanie hase³ u¿ytkowników z poziomu menu rozwijanego, ród³o: Opracowanie w³asne.}
%	\label{rys:ResetujHaslo}
%\end{figure}

Nastêpnie pojawia siê okno, w którym z listy rozwijanej administrator wybiera konto. Aby zresetowaæ konto nale¿y klikn¹æ przycisk \textit{Resetuj}.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{reset2.jpg}
%    \caption{Okno resetowania hase³, ród³o: Opracowanie w³asne.}
%	\label{rys:ResetujHaslo2}
%\end{figure}

Je¿eli operacj¹ powiod³a siê, u¿ytkownik otrzyma komunikat.

%\begin{figure}[ht]
%    \centering
%    \includegraphics[width=0.35\textwidth]{reset3.jpg}
%    \caption{Komunikat o poprawnym usuniecia konta, ród³o: Opracowanie w³asne.}
%	\label{rys:ResetujHaslo3}
%\end{figure}

\subsection{Modyfikacja s³owników cenowych}

 
\section{Specyfikacja wewnêtrzna}

\subsection{Przeprowadzenie operacji logowania u¿ytkownika}
\subsubsection{Bezpieczeñstwo procesu logowania}

Modu³ logowania jest czêœci¹ systemu, do którego dostêp ma ka¿dy u¿ytkownik korzystaj¹cy z prezentowanej aplikacji. Implikuje to koniecznoœæ jego zabezpieczenia przed niepowo³anym u¿yciem dotycz¹cym dostêpu do poufnych danych, takich jak dane osobiste oraz has³a, dla których dobr¹ praktyk¹ odnosz¹c¹ siê do bezpieczeñstwa jest ich nieprzechowywanie w ¿adnym miejscu w postaci jawnej.

Pole wpisywania has³a przez u¿ytkownika w oknie logowania stanowi dedykowana dla tego celu kontrolka PasswordBox, dostêpna do wgl¹du na rysunku \ref{rys:PasswordBox}. Jest to zmodyfikowana kontrolka TextBox dostêpna w technologi WPF, która wyœwietla swoj¹ zawartoœæ w postaci ukrytej, uniemo¿liwiaj¹c jednoczeœnie wykonanie na jej zawartoœci operacji kopiowania oraz wycinania z poziomu klawiatury oraz myszy. Zabezpiecza to przed niechcianym podejrzeniem has³a oraz jego odzyskaniem przez osobê trzeci¹.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.5\textwidth]{PasswordBox.jpg}
    \caption{Kontrolka PasswordBox z przedstawieniem aspektów bezpieczeñstwa, ród³o: Opracowanie w³asne.}
    \label{rys:PasswordBox}
\end{figure}

Sama operacja sprawdzania poprawnoœci wpisanego has³a zosta³a zaprojektowana w taki sposób, aby otrzymane z kontrolki has³o nie by³o nigdzie zapisywane i porównywane w postaci jawnej. W chwili wpisania has³a przez u¿ytkownika oraz klikniêcia przycisku logowania, nastêpuje sprawdzenie ustalonych zasad dotycz¹cych z³o¿onoœci has³a opisanych w rozdziale \ref{dzial:ZlozonoscHasel} oraz w sytuacji ich pozytywnego rozpatrzenia, has³o przekszta³cane jest za pomoc¹ 256-bitowej odmiany algorytmu haszuj¹cego SHA-2 na skrót, który porównywany jest ze skrótem has³a dopasowanemu wpisanej nazwie u¿ytkownika u¿ytkownika w bazie danych. Na tej podstawie przyznawany lub odmawiany jest dostêp do dalszej czêœci programu.

%TODO: hasze hasel screen z bazy jak wlaczy sie hashowanie



\subsubsection{Wymagania z³o¿onoœci hase³}
\label{dzial:ZlozonoscHasel}

Ustalenie has³a przez u¿ytkownika programu implikuje obowi¹zek walidacji wprowadzonego przez niego ci¹gu znaków w celu sprawdzenia jego poziomu bezpieczeñstwa. Krótkie has³a s¹ bardziej podatne próbê ich z³amania, ni¿ d³u¿sze ci¹gi, sk³adaj¹ce siê zarówno z liter jak i cyfr. W tym celu, w czasie ustalania przez u¿ytkownika nowego has³a, wprowadzona zosta³a metoda widoczna przy kodzie Ÿród³owym \ref{listing:ValidatePasswordMethod}, której zadaniem jest weryfikacja za³o¿onych z góry aspektów, które musi has³o spe³niaæ w celu jego akceptacji. Wymogami tymi jest d³ugoœæ has³a, które sk³adaæ siê musi z przynajmniej oœmiu znaków, posiadanie minimum jednej du¿ej oraz ma³ej litery, a tak¿e obecnoœæ w jego sk³adzie cyfry. W przypadku niespe³nienia chocia¿ jednej z przedstawionych zasad, has³o jest automatycznie odrzucane, a u¿ytkownik informowany jest o zaistnia³ym problemie.

\begin{lstlisting}[caption={Metoda weryfikuj¹ca poprawnoœæ wpisanego przez u¿ytkownika has³a}, label={listing:ValidatePasswordMethod}]

public static bool ValidatePassword(string pass)
{
    // minimalna wymagana d³ugoœæ has³a
    const int minLength = 8;
    // sprawdzenie czy has³o jest puste
    if (pass == null) 
        return false;
    // sprawdzenie poprawnoœci d³ugoœci has³a
    bool isPassLengthOk = pass.Length >= minLength;
    bool hasUpperCaseChar = false;
    bool hasLowerCaseChar = false;
    bool hasDecimalDigit = false;
    if (isPassLengthOk)
    {
        // sprawdzanie czy has³o zawiera du¿¹ literê, ma³¹ literê oraz cyfrê
        foreach (char letter in pass)
        {
            if (char.IsUpper(letter)) 
            	hasUpperCaseChar = true;
            else if (char.IsLower(letter)) 
            	hasLowerCaseChar = true;
            else if (char.IsDigit(letter)) 
            	hasDecimalDigit = true;
        }
    }
    bool isValid = (isPassLengthOk && hasUpperCaseChar
                    && hasLowerCaseChar && hasDecimalDigit);
    // true == has³o poprawne, false == has³o niepoprawne
    return isValid;
}

\end{lstlisting}

\subsection{Konto administratora i u¿ytkownika – ListView}
U¿ytkownik mo¿e ogl¹daæ swoje propozycje ich iloœæ jak i z jak firmami zwi¹zana jest dana propozycja cenowa. Do tego celu nie mo¿na w bezpoœredni sposób wykorzystaæ bazy danych lecz zosta³a stworzona warstwa poœrednia w postaci klasy AdminProposition. Klasa ta zawiera pola wymagane do wyœwietlenia propozycji cenowej w postaci imiê nazwisko osoby odpowiedzialnej, status, jeœli dana propozycja cenowa jest dla firmy to firmê. Wykorzystuj¹c polecenia LINQ s¹ pobierane dane z bazy danych i wykorzystuj¹c wbudowane mechanizmy, jest tworzona lista propozycji z wymaganymi polami. Przedstawia to  listing \ref{listing:propuser}
\begin{lstlisting}[caption= {Polecenie wyci¹gaj¹ce wszystkie propozycje u¿ytkownika} \label{listing:propuser}]
 var myProposition = (from prop in _ctx.Proposition
                      from user in _ctx.Users 
                      where user.Id == _userId		
                      where prop.Id_user == _userId 
            // szuka propozycji u¿ytkownika zalogowanego
            select new AdminProposition
            {
             PropositionId = prop.Id,
             UserFirstName = user.Name,
             UserSurname = user.Surname,
             CustomerFullName = prop.PropClient
             				.CustomerFullName,
             CompanyName = prop.PropClient.CompanyName,
             UpdateDate = prop.UpdateDate,
             Status = prop.Status
            }).ToList();
            PropositionsList = myProposition; 
//przypisanie do listy propozycji 
//w prawid³owej formie do wyœwietlenia
\end{lstlisting}
Administrator ma równie¿ dodatkow¹ mo¿liwoœæ wybierania propozycji danego u¿ytkownika. Wykorzystuj¹c mo¿liwoœci jêzyka LINQ tworzona jest lista wszystkich u¿ytkowników maj¹cych jakiekolwiek propozycje cenowe i przypisanie ich do ComboBox. Proces przypisywania prezentuje listing \ref{listing:user} Wraz z wyborem u¿ytkownika z tej listy nastêpuje odœwie¿enie ListView z propozycjami. 
\begin{lstlisting}[caption= {Polecenie wyci¹gaj¹ce wszystkie propozycje u¿ytkownika} \label{listing:user}]
 var userlist = (from s in _ctx.Users
                     where s.Proposition.Any()
                     select s).ToList();
            userlist.Add(new Users()); 
 //dodanie pustego u¿ytkownika by 
 //móc wyœwietliæ wszystkie propozycje
            UsersList = userlist;

\end{lstlisting}

Edycja propozycji w obydwu przypadkach odbywa siê w ten sam sposób poprzez wybranie propozycji z ListView nastêpuje przypisanie identyfikatora z bazy danych do zmiennej i wyszukanie wszystkich elementów danej propozycji. Z kolei wype³niane s¹ wszystkie pola, które zosta³y zaznaczone. 

\subsection{Tworzenie propozycji cenowej}

Modu³ tworzenia propozycji cenowej wraz z modu³em jej edycji jest najbardziej rozbudowanym modu³em prezentowanej aplikacji, który przez fakt aktywnej komunikacji z baz¹ danych w celu pobrania potrzebnych s³ownikowych oraz zapisu wybranych przez u¿ytkownika elementów posiada skomplikowan¹ logikê dzia³ania. 
Najwa¿niejszym elementem koniecznym do prawid³owej pracy prezentowanego modu³u by³a kontrola przesy³anych pomiêdzy baz¹ a aplikacj¹ danych. Pola obiektów, które zawiera³y puste wartoœci wymaga³y szczegó³owej kontroli i konwersji typu NULL na typ obs³ugiwany przez odbiorcê. Wymóg ten by³ konieczny przez wzgl¹d na mo¿liwoœæ wyst¹pienia wyj¹tku, który przerywa³ pracê ca³ej aplikacji. Zgodnie z za³o¿eniami projektowymi, u¿ytkownik w czasie tworzenia propozycji cenowej ma mo¿liwoœæ wype³niania tylko jej czêœci. Dodaj¹c do tego fakt, i¿ u¿ytkownik przypadkowo mo¿e wype³niæ dla przyk³adu rekord zawieraj¹cy element gastronomiczny bez wpisania jego dni lub iloœci, szczegó³owa kontrola zawartoœci obiektów by³a priorytetowa. W sytuacji nie wpisania wszystkich kolumn rekordu odnosz¹cego siê do elementu zak³adki opisywanej w punktach \ref{dzial:SalaIWyposazenieUzytkownik}, \ref{dzial:UslugiGastronomiczneUzytkownik}, \ref{dzial:UslugiNoclegoweUzytkownik} oraz \ref{dzial:UslugiDodatkoweIPlatnoscUzytkownik}, przy zapisie propozycji do bazy danych, rekord ten jest wychwytywany przez mechanizmy waliduj¹ce i usuwany.

\subsection{Edycja s³owników oraz kont u¿ytkowników}
\subsubsection{DataGridView a dynamiczna komunikacja z Baz¹ danych}

Aby umo¿liwiæ edycjê danych z poziomu DataGridView, zaimplementowano funckjê obs³uguj¹c¹ zdarzenie \textit{DataGridRowEditEndingEventArgs}. Kiedy edycja danej komórki zostaje zakoñczona, wywo³ywana jest funkcja której zadaniem jest dynamiczne przechwytywanie nowych wartoœci oraz aktualizacja bazy danych. U¿ycie zmiennej dynamic, podyktowane jest faktem, i¿ jest ona sprawdzana podczas wywo³ania, a nie kompilacji \cite{dynamic}. Umo¿liwia to odwo³anie do nowych wartoœci zapisanych w komórkach. Funkcja jest wykorzystywana w module s³u¿¹cym do edycji danych pracowników. Poni¿ej znajduje siê kod Ÿród³owy funkcji:

\begin{lstlisting}[caption= {Implementacja i opis funkcji aktualizuj¹cej bazê danych z poziomu DataGridView}, label={listing:DynamicGridView}]

//pobranie identyfikatora u¿ytkownika którego wiersz 
//jest zaznaczony w DataGridView oraz zapis do zmiennej typu int
object item = UserList.SelectedItem;
string ID = 
    (UserList.SelectedCells[0]
             .Column
             .GetCellContent(item) as TextBlock).Text;

int selected = Int32.Parse(ID);

//zapis danych z poszczególnych kolumn do zmiennej dynamicznej
dynamic userRow = UserList.SelectedItem;

//konwersja rodzaju konta z liczby na tekst
int tmp = 0;
if (userRow.UserAccountType == "Administrator")
	tmp = 1;
else
    tmp = 2;

//deklaracja obiektu bazy danych
DiamondDBEntities _ctx = new DiamondDBEntities();
Users userUpdate = (from user in _ctx.Users
                    where user.Id == selected
                    select user).First();
	
	//przypisanie nowych wartoœci z komórek do poszczególnych 
	//kolumn tabeli Users
	userUpdate.Name = userRow.UserName;
	userUpdate.Surname = userRow.UserSurname;
	userUpdate.PhoneNum = userRow.UserPhoneNumber;
	userUpdate.Email = userRow.UserEmail;
	userUpdate.Position = userRow.UserPosition;
	userUpdate.AccountType = tmp;
	userUpdate.Login = userRow.UserLogin;
	
	//zapis danych do bazy
	_ctx.SaveChanges();
\end{lstlisting}

\subsection{Tworzenie szablonu PDF propozycji cenowej}

Za pomoc¹ mechanizmów biblioteki MigraDoc, zaimplementowano funckje tworz¹ce tabele propozycji cenowej:
\begin{verbatim}
//inicjalizacja nowej tabeli
Table table = document.LastSection.AddTable();
table.Borders.Visible = true;
table.Format.Font.Size = 10;
table.Format.Font.Name = "Calibri";

//dodawanie nowej kolumny
Column column = table.AddColumn("3.750cm");
column.Format.Alignment = ParagraphAlignment.Left;

//dodawanie nowego wiersza, z przyk³adowymi atrybutami
Row row = table.AddRow();
row.Cells[0].Shading.Color = Colors.LightGray;
row.Cells[0].AddParagraph("WYNAJEM");
\end{verbatim}

Poni¿szy kod, umo¿liwia zapis dokumentu w formacie PDF.

\begin{verbatim}
// deklaracja obiektu klasy PdfDocumentRenderer
PdfDocumentRenderer renderDocument = 
    new PdfDocumentRenderer(true,PdfSharp.Pdf.PdfFontEmbedding.Always);
//renderowanie dokumentu
renderDocument.Document = document;
renderDocument.RenderDocument();
//zapis do pliku
renderDocument.Save(path);
\end{verbatim}

\section{Podsumowanie i perspektywy rozwoju \newlineTekst oprogramowania}

Celem prezentowanego projektu by³o wykonanie aplikacji bazodanowej wspieraj¹cej pracê wybranej sieci hotelowej, która umo¿liwia zautomatyzowanie procesu tworzenia propozycji cenowej, uproszczenie sposobu aktualizacji wszelkich cenników us³ug dostêpnych w hotelu oraz mo¿liwoœæ kontroli pracowników przez kierownictwo. Przedstawione cele zosta³y w pe³ni zrealizowane, czego efektem jest dzia³aj¹ca aplikacja bazodanowa posiadaj¹ca szereg modu³ów umo¿liwiaj¹cych ich osi¹gniêcie. 

Dziêki zastosowaniu œrodowiska bazodanowego, pracownicy maj¹ pewnoœæ, i¿ dane dotycz¹ce cen us³ug na których pracuj¹ s¹ danymi aktualnymi, które aktualizowane s¹ na bie¿¹co z poziomu konta menad¿era sprzeda¿y. Aspekt ten usprawnienia proces aktualizacji danych, niweluj¹c potrzebê korzystania ze skrzynek elektronicznych. Menad¿er sprzeda¿y w sytuacji aktualizacji danej ceny ma obowi¹zek edycji odpowiedniej tabeli z poziomu swojego uprzywilejowanego konta, a po³¹czenie aplikacji z baz¹ danych automatycznie zapewni wprowadzenie zmiany na kontach wszystkich pracowników. Baza danych oraz skategoryzowanie wszystkich produktów gastronomicznych, zwalnia natomiast z u¿ytkownika koniecznoœæ manualnego wyszukiwania okreœlonego elementu w czasie tworzenia propozycji cenowej. Wprowadzona funkcja kategorii, umo¿liwia wybór okreœlonego typu produktu oraz kolejno wybranie go z listy która pozbawiona jest wszystkich produktów, które do wybranej kategorii nie zosta³y przypisane. Korzyœci¹ p³yn¹c¹ z przedstawionej funkcji jest oszczêdnoœæ czasu pracownika, która umo¿liwia przyspieszenie procesu tworzenia nowej propozycji cenowej lub edycji ju¿ istniej¹cej. Ka¿da propozycja cenowa, dziêki przypisaniu do osoby, która j¹ tworzy³a mo¿liwa jest równie¿ do wgl¹du z poziomu uprzywilejowanego konta. Dziêki temu kierownictwo ma mo¿liwoœæ przegl¹dania przygotowywanych przez pracowników ofert, a co za tym idzie wzgl¹d we wszelkie ustalone z klientami ceny oraz zni¿ki.

W fazie implementacji za³o¿onych modu³ów prezentowanej aplikacji napotkano na wiele problemów zwi¹zanych ze zmian¹ wymagañ projektowych i sposobem realizacji ustalonych funkcjonalnoœci. Wraz z biegiem czasu powstawa³y nowe pomys³y dotycz¹ce usprawnienia istniej¹cych rozwi¹zañ, które niejednokrotnie zwiêkszy³yby ich wydajnoœæ oraz efektywnoœæ. Rozwi¹zania te nie zawsze mog³y byæ jednak wprowadzone przez pryzmat czasu którego to wymaga³y w celu ich implementacji, przetestowania oraz po³¹czenia z istniej¹cym ju¿ systemem. Proponowane zmiany wi¹za³y siê tak¿e z modyfikacj¹ istniej¹cej architektury systemu, co w znacz¹cy sposób zmienia³oby zaplanowany wczeœniej harmonogram prac i wyd³u¿a³oby finalne ukoñczenie projektu.

Pierwszym pomys³em rozbudowy prezentowanego systemu jest wprowadzenie funkcji tworzenia propozycji offline. Zgodnie z ustalonymi wymaganiami projektowymi, osoba korzystaj¹ca z aplikacji zobowi¹zana jest do posiadania dostêpu do sieci Internet. W przypadku jego braku, praca z programem przez wzgl¹d na koniecznoœæ weryfikacji to¿samoœci na podstawie bazy danych jest niemo¿liwa. Wersja offline wprowadzi³aby mo¿liwoœæ stworzenia nowej propozycji cenowej w sytuacji braku po³¹czenia internetowego oraz zapis wszystkich jego elementów w postaci pliku na lokalnym dysku twardym. Implikuje to jednak szereg problemów do rozwi¹zania na tle synchronizacji z baz¹ danych oraz szablonu tworzonej propozycji. W sytuacji utworzenia nowej propozycji offline oraz póŸniejszym uzyskaniu dostêpu do sieci, wszystkie jej elementy synchronizowane byæ powinny z baz¹ danych oraz lokalnie usuwane. Komplikacja na tle schematu tworzenia propozycji dotyczy³aby z kolei sposobu wype³nienia pól, których zawartoœæ zale¿na jest od bazy danych.

Nastêpn¹ modyfikacj¹ mo¿liw¹ do wprowadzenia w przypadku rozwoju projektu jest modyfikacja obecnie zaimplementowanego szablonu wyboru elementów dostêpnych us³ug. W chwili obecnej liczba mo¿liwych do wyboru elementów ka¿dej us³ugi jest z góry ustalona. Modyfikacja wprowadza³aby dynamicznie rozwijane rekordy, których liczba zale¿na by³aby od liczby wybranych elementów. Zmiana ta g³êboko ingerowa³aby w obecn¹ architekturê modu³u tworzenia propozycji i wymaga³aby jej gruntownej przebudowy dotycz¹cej zmiany stosowanych kontrolek graficznych, implementacji ich zachowañ oraz walidacji wprowadzanych danych.

%% UWaga na \newlineTekst oraz \newlineSpis. Mo¿na te¿ u¿yæ \newline, dzia³a jak \newlineSpis\newlineTekst
\section[Tytu³ drugiego rozdzia³u. Bardzo d³ugi \ldots]
        {Tytu³ drugiego rozdzia³u. \newlineTekst Bardzo d³ugi tytu³. \newlineTekst
          Jego \newlineSpis formatowanie jest trudniejsze}
CACHE

Tu jest wnêtrze rozdzia³u drugiego.

\dodatek{Mój specjalny dodatek}

CACHE

Tu treœæ dodatku. Zwróæmy uwagê na sposób numerowania dodatku, 
mo¿liwa jest zmiana numerowania, patrz wyjaœnienia.
          
%% to wpisuje siê do spisu treœci, ale bez numeru rozdzia³u,
%% mo¿na te¿ u¿ywaæ \dodatek{Tytu³}, który jest numerowany, ale inaczej ni¿ rozdzia³y.

\dodatkowo{Za³¹czniki}
CACHE zalaczniki

\vrule\hspace{10pt}\begin{minipage}{10cm}
\begin{verbatim*}
<?php
   echo "test=$test";
?>
\end{verbatim*}
\end{minipage}

\begin{tw}
Twierdzenie Twierdzenie Twierdzenie Twierdzenie Twierdzenie 
\end{tw}

\begin{thebibliography}{12}

%Seba wstêp
\bibitem{LiczbaHoteli} 
http://www.wykresy.net/liniowe/liczba-hoteli-w-polsce-ostatnie-12-lat.html

%Lisu wstêp
\bibitem {iloscFirm}
http://stat.gov.pl/obszary-tematyczne/podmioty-gospodarcze-wyniki-finansowe/przedsiebiorstwa-niefinansowe/male-i-srednie-przedsiebiorstwa-niefinansowe-w-polsce-w-latach-2009-2013,22,1.html

% 
\bibitem {SystemERP}
Jerzy Kisielnicki, Ma³gorzata Pañkowska, Henryk Sroka.:\textsl{Zintegrowane systemy informatyczne. Dobre praktyki wdro¿eñ systemów klasy ERP}, Wydawnictwo Naukowe PWN, Warszawa, 2012

\bibitem {ProfitCRM}
http://www.profitcrm.pl/crm
\bibitem {AsystentCRM}
http://meteoryt.pl/
\bibitem {Gestor}
https://www.insert.com.pl

\bibitem {Clr}
https://msdn.microsoft.com/pl-pl/library/w0x726c2(v=vs.110).aspx

\bibitem {Clr2}
https://msdn.microsoft.com/pl-pl/vstudio/cc511286

\bibitem {Bcl}
http://www.thebestcsharpprogrammerintheworld.com/fundamentals/Base-Class-Library.aspx

\bibitem {Fcl}
http://www.etechpulse.com/2013/04/difference-between-bcl-and-fcl-in-net.html

\bibitem {Cts}
https://msdn.microsoft.com/en-us/library/zcx1eb1e(v=vs.110).aspx

\bibitem {Cls}
https://msdn.microsoft.com/library/12a7a7h3(v=vs.100).aspx

\bibitem {CRanking}
http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html

\bibitem {chash}
http://antyweb.pl/hello-world-czyli-krotka-historia-jezykow-programowania/

\bibitem {cadv}
http://urriellu.net/en/articles-software/csharp-advantages.html

\bibitem {WPF}
 Adam Nathan \textsl{WPF 4.5. Ksiêga eksperta}, Wydawnictwo Helion, Gliwice , 2015
 
%Seba xml
\bibitem{Xml}
http://www.w3schools.com/xml/xml\_whatis.asp
%Lis T_SQL
\bibitem {bazy}
Jeffrey D. Ullman, Jennifer Widom
\textsl{Podstawowy kurs systemów baz danych. Wydanie III} Wydawnictwo Helion, Gliwice , 2011 
%LIS Visual Studio
\bibitem {VS}
https://www.visualstudio.com/pl-pl/downloads/download-visual-studio-vs.aspx

\bibitem {VSG}
https://visualstudiogallery.msdn.microsoft.com

%Lisu SQL Server Management Studio
\bibitem{SQL Server Management Studio Express}
https://www.microsoft.com/en-us/download/details.aspx?id=29062
%Nazwisko I. \textsl{tytu³}, miasto, rok

%Seba trello
\bibitem{Kanban}
Krasiñski M.: \textsl{Nauki o zarz¹dzaniu}, Wydawnictwo Uniwersytetu Ekonomicznego we Wroc³awiu, Wroc³aw, 2013, str.24-32

\bibitem{PlatformyTrello} 
https://trello.com/platforms

\bibitem{version} 
http://www.gajdaw.pl/varia/subversion-system-kontroli-wersji-tutorial/p1.html

\bibitem{versionrodzaje}
http://blog.undicom.pl/systemy-kontroli-wersji-ktore-wybrac/

\bibitem{git0}
https://git-scm.com/book/en/v2/Getting-Started-A-Short-History-of-Git

\bibitem{git}
https://git-scm.com/

\bibitem{gitadv}
http://leniwy.eu/news,18,Git-poradnik-poczatkujacego.html

\bibitem{treelic}
https://answers.atlassian.com/questions/303753/sourcetree-free-license

\bibitem{tree}
https://www.atlassian.com/software/sourcetree/overview

\bibitem{github}
https://github.com/blog/40-we-launched

%Seba ReSharper
%znalesc ksiazke w ktorej jest opis .NET
\bibitem{.NETOpis}
Chappell D.: \textsl{Understanding .NET (2nd Edition)}, Wydawnictwo Addison-Wesley Professional, Boston 2006

\bibitem{MartwyKod}
Martin R.C.: \textsl{Czysty kod. Podrêcznik dobrego programisty}, Wydawnictwo Helion, Gliwice 2014

\bibitem{ReSharperFunkcje} 
https://www.jetbrains.com/resharper/features/

\bibitem{jenkins}
https://wiki.jenkins-ci.org/display/JENKINS/Meet+Jenkins

\bibitem{jenkins2}
http://techwriter.pl/jenkins-opis-narzedzia/

\bibitem{MicrosoftPublicLicence} 
https://opensource.org/licenses/MS-PL

\bibitem{DefinicjaPdf}
https://acrobat.adobe.com/pl/pl/products/about-adobe-pdf.html

\bibitem{PopularnoscPdf} 
http://www.download.net.pl/jak-zapisac-dowolny-dokument-do-pliku-pdf/n/3662/

\bibitem{PdfSharp} 
http://www.pdfsharp.net/

%Seba wpf extended - na razie brak

%Seba wzorce architektoniczne oprogramowania
\bibitem{FazyProdukcjiOprogramowania} 
Jaszkiewicz A. \textsl{In¿ynieria oprogramowania}, Wydawnictwo Helion, 1997

\bibitem{MvvmOpis} 
Petzold C. \textsl{Windows 8. Programowanie aplikacji z wykorzystaniem C\# i XAML}, Wydawnistwo Helion, Gliwice 2013

\bibitem{LogikaBiznesowa}
Borycki D., Matulewski J., Pakulski M., Grabek M.: \textsl{ASP.NET MVC. Kompletny przewodnik dla programistów interaktywnych aplikacji internetowych w Visual Studio}, Wydawnictwo Helion, Gliwice 2014

\bibitem{DataBinding}
MacDonald M., \textsl{Pro WPF 4.5 in VB: Windows Presentation Foundation in .NET 4.5}, Wydawnictwo Apress, 2012

%Seba entity
\bibitem{AdnotacjeCodeFirst}
https://msdn.microsoft.com/en-us/data/jj591583

\bibitem{LINQ}
Magennis T., \textsl{LINQ to Objects w C\# 4.0}, Wydawnictwo Helion, Gliwice 2012

\bibitem{ci}
http://www.martinfowler.com/articles/continuousIntegration.html

\bibitem{cdel}
http://www.infoq.com/articles/cd-benefits-challenges

\bibitem{cdr}
https://puppetlabs.com/blog/continuous-delivery-vs-continuous-deployment-whats-diff

%Seba techiczne logowanie
\bibitem{SHA1Slabosc}
Bruce Schneier, Schneier on Security: Cryptanalysis of SHA-1, 2005

\bibitem{dynamic}
http://www.pzielinski.com/?p=831




%Nazwisko I. \textsl{tytu³}, miasto, rok


%---

\end{thebibliography}

\listoffigures

\lstlistoflistings
\end{document}
